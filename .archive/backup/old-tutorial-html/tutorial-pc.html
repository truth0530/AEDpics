<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AED 스마트 점검 시스템 - 튜토리얼</title>
    <!-- 카카오맵 API -->
    <script type="text/javascript" src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=6ed19a9804e3b0978db781ba6082d1f7&autoload=false"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #0a0a0a;
            color: #ffffff;
            min-height: 100vh;
        }

        /* 헤더 스타일 */
        .header {
            background: #111111;
            border-bottom: 1px solid #333;
            padding: 0 20px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

        .logo {
            font-size: 20px;
            font-weight: 700;
            color: #10b981;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .user-name {
            color: #888;
            font-size: 14px;
        }

        .btn-logout {
            background: transparent;
            border: 1px solid #666;
            color: #888;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .btn-logout:hover {
            border-color: #10b981;
            color: #10b981;
        }

        /* 사이드바 스타일 */
        .sidebar {
            position: fixed;
            left: 0;
            top: 60px;
            bottom: 0;
            width: 250px;
            background: #111111;
            border-right: 1px solid #333;
            padding: 20px 0;
            overflow-y: auto;
        }

        .menu-item {
            padding: 12px 20px;
            color: #888;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .menu-item:hover {
            background: #1a1a1a;
            color: #ffffff;
        }

        .menu-item.active {
            background: #1a1a1a;
            color: #10b981;
            border-left: 3px solid #10b981;
        }

        .menu-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* 메인 콘텐츠 영역 */
        .main-content {
            margin-left: 250px;
            margin-top: 60px;
            padding: 30px;
            min-height: calc(100vh - 60px);
        }

        /* 페이지 섹션 */
        .page-section {
            display: none;
        }

        .page-section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* 모바일 메뉴 버튼 */
        .mobile-menu-btn {
            display: none;
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 1100;
            background: #10b981;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px;
            cursor: pointer;
        }

        @media (max-width: 768px) {
            .mobile-menu-btn {
                display: block;
            }
        }

        /* 빠른 액션 바 */
        .quick-actions {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 30px;
            padding: 10px 20px;
            display: flex;
            gap: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
            z-index: 900;
        }

        .quick-action-btn {
            background: transparent;
            border: none;
            color: #888;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .quick-action-btn:hover {
            background: #333;
            color: #10b981;
        }

        /* 알림 센터 */
        .notification-center {
            position: fixed;
            top: 70px;
            right: 20px;
            width: 300px;
            max-height: 400px;
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 12px;
            overflow: hidden;
            display: none;
            z-index: 999;
        }

        .notification-header {
            padding: 15px;
            background: #111;
            border-bottom: 1px solid #333;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .notification-list {
            max-height: 350px;
            overflow-y: auto;
        }

        .notification-item {
            padding: 15px;
            border-bottom: 1px solid #222;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .notification-item:hover {
            background: #222;
        }

        .notification-time {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }

        /* 대시보드 스타일 */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 20px;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.5);
        }

        .stat-label {
            color: #888;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: #ffffff;
        }

        .stat-card.danger .stat-value {
            color: #ff4444;
        }

        .stat-card.warning .stat-value {
            color: #ffaa00;
        }

        .stat-card.success .stat-value {
            color: #44ff44;
        }

        /* 테이블 스타일 */
        .data-table {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 12px;
            overflow: hidden;
        }

        .table-header {
            padding: 20px;
            border-bottom: 1px solid #333;
        }

        .table-title {
            font-size: 18px;
            font-weight: 600;
            color: #ffffff;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background: #111111;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: #888;
            font-size: 14px;
        }

        td {
            padding: 12px;
            border-top: 1px solid #222;
            color: #e0e0e0;
            font-size: 14px;
        }

        tr:hover {
            background: #222;
        }

        /* 버튼 스타일 */
        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }

        .btn-primary {
            background: #10b981;
            color: white;
        }

        .btn-primary:hover {
            background: #357abd;
            transform: translateY(-1px);
        }

        .btn-success {
            background: #44ff44;
            color: #000;
        }

        .btn-danger {
            background: #ff4444;
            color: white;
        }

        .btn-secondary {
            background: #333;
            color: #888;
            border: 1px solid #555;
        }

        /* 배지 스타일 */
        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
        }

        .badge-danger {
            background: rgba(255,68,68,0.2);
            color: #ff4444;
        }

        .badge-warning {
            background: rgba(255,170,0,0.2);
            color: #ffaa00;
        }

        .badge-success {
            background: rgba(68,255,68,0.2);
            color: #44ff44;
        }

        .badge-info {
            background: rgba(74,144,226,0.2);
            color: #10b981;
        }

        /* 검색바 스타일 */
        .search-bar {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .search-input {
            flex: 1;
            background: #1a1a1a;
            border: 1px solid #333;
            color: #ffffff;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 14px;
        }

        .search-input:focus {
            outline: none;
            border-color: #10b981;
        }

        /* 모바일 반응형 */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }

        /* 튜토리얼 오버레이 */
        .tutorial-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .tutorial-modal {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
        }

        .tutorial-title {
            font-size: 24px;
            font-weight: 700;
            color: #10b981;
            margin-bottom: 20px;
        }

        .tutorial-content {
            color: #e0e0e0;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        /* 진행 표시기 */
        .progress-bar {
            background: #333;
            height: 4px;
            border-radius: 2px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            background: #10b981;
            height: 100%;
            transition: width 0.3s ease;
        }

        /* 플로팅 액션 버튼 */
        .fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: #10b981;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(74,144,226,0.4);
            transition: all 0.3s ease;
            font-size: 24px;
        }

        .fab:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(74,144,226,0.6);
        }
        
        /* 맵 핀 애니메이션 */
        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
            100% {
                transform: scale(1);
            }
        }
        
        /* 스크롤바 스타일 */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #1a1a1a;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #444;
        }
    </style>
</head>
<body>
    <!-- 헤더 -->
    <div class="header">
        <div class="logo">AED 스마트 점검 시스템</div>
        <div class="user-info">
            <select id="userRole" onchange="changeUserRole()" style="background: #222; color: #888; border: 1px solid #666; padding: 6px 12px; border-radius: 6px; margin-right: 10px;">
                <option value="local">홍길동 (보건소 담당자)</option>
                <option value="regional">김관리 (서울시 담당자)</option>
                <option value="ministry">이감독 (복지부 담당자)</option>
                <option value="emergency">박센터 (중앙응급의료센터)</option>
            </select>
            <button class="btn-logout" onclick="showAlert('로그아웃')">로그아웃</button>
        </div>
    </div>

    <!-- 사이드바 -->
    <div class="sidebar" id="sidebar">
        <div class="menu-item active" onclick="showPage('inspection')">
            <span class="menu-icon">✓</span>
            <span>점검 관리</span>
        </div>
        <div class="menu-item" onclick="showPage('dashboard')">
            <span class="menu-icon">□</span>
            <span>대시보드</span>
        </div>
        <div class="menu-item" onclick="showPage('devices')">
            <span class="menu-icon">◆</span>
            <span>장비 관리</span>
        </div>
        <div class="menu-item" onclick="showPage('priority')">
            <span class="menu-icon">!</span>
            <span>우선순위 관리</span>
        </div>
        <div class="menu-item" onclick="showPage('team')">
            <span class="menu-icon">▤</span>
            <span>팀 협업</span>
        </div>
        <div class="menu-item" onclick="showPage('reports')">
            <span class="menu-icon">▥</span>
            <span>보고서</span>
        </div>
        <div class="menu-item" onclick="showPage('settings')">
            <span class="menu-icon">☰</span>
            <span>설정</span>
        </div>
    </div>

    <!-- 메인 콘텐츠 -->
    <div class="main-content">
        <!-- 대시보드 페이지 -->
        <div id="dashboard" class="page-section">
            <h1 style="margin-bottom: 30px;">대시보드</h1>
            
            <!-- 권한별 필터 영역 -->
            <div id="dashboardFilter" style="margin-bottom: 20px; padding: 15px; background: #1a1a1a; border-radius: 8px; display: none;">
                <div style="display: flex; gap: 15px; align-items: center;">
                    <label style="color: #888;">지역 선택:</label>
                    <select id="regionFilter" style="background: #222; color: #fff; border: 1px solid #666; padding: 8px 12px; border-radius: 6px;" onchange="updateDashboard()">
                        <option value="all">전체</option>
                        <option value="seoul">서울특별시</option>
                        <option value="busan">부산광역시</option>
                        <option value="daegu">대구광역시</option>
                        <option value="incheon">인천광역시</option>
                        <option value="gwangju">광주광역시</option>
                        <option value="daejeon">대전광역시</option>
                        <option value="ulsan">울산광역시</option>
                        <option value="sejong">세종특별자치시</option>
                        <option value="gyeonggi">경기도</option>
                        <option value="gangwon">강원도</option>
                        <option value="chungbuk">충청북도</option>
                        <option value="chungnam">충청남도</option>
                        <option value="jeonbuk">전라북도</option>
                        <option value="jeonnam">전라남도</option>
                        <option value="gyeongbuk">경상북도</option>
                        <option value="gyeongnam">경상남도</option>
                        <option value="jeju">제주특별자치도</option>
                    </select>
                    <select id="districtFilter" style="background: #222; color: #fff; border: 1px solid #666; padding: 8px 12px; border-radius: 6px; display: none;" onchange="updateDashboard()">
                        <option value="all">전체 구/군</option>
                    </select>
                </div>
            </div>
            
            <div class="dashboard-grid">
                <div class="stat-card">
                    <div class="stat-label">관리 중인 전체 AED</div>
                    <div class="stat-value" id="totalAED">327</div>
                </div>
                <div class="stat-card danger">
                    <div class="stat-label">긴급 점검 필요 (배터리/패드 만료)</div>
                    <div class="stat-value">42</div>
                </div>
                <div class="stat-card warning">
                    <div class="stat-label">30일 내 만료 예정</div>
                    <div class="stat-value">18</div>
                </div>
                <div class="stat-card success">
                    <div class="stat-label">오늘 점검 완료</div>
                    <div class="stat-value">12</div>
                </div>
            </div>

            <div class="data-table">
                <div class="table-header">
                    <h2 class="table-title">긴급 점검 필요 목록</h2>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>설치기관명</th>
                            <th>장비연번</th>
                            <th>상태</th>
                            <th>배터리유효기간</th>
                            <th>패드유효기간</th>
                            <th>장비유효기간</th>
                            <th>최근점검일자</th>
                            <th>작업</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>서울시청</td>
                            <td>13-0000042</td>
                            <td><span class="badge badge-danger">긴급</span></td>
                            <td>2024-12-31</td>
                            <td>2025-03-15</td>
                            <td>2032-01-15</td>
                            <td>2024-12-01</td>
                            <td>
                                <button class="btn btn-primary" onclick="showInspection()" style="margin-right: 5px;">점검</button>
                                <button class="btn btn-secondary" onclick="startNavigation('서울시청', '37.5662952', '126.9779451')" style="font-size: 12px;">길안내</button>
                            </td>
                        </tr>
                        <tr>
                            <td>강남구청</td>
                            <td>13-0000156</td>
                            <td><span class="badge badge-warning">주의</span></td>
                            <td>2025-02-20</td>
                            <td>2025-01-15</td>
                            <td>2033-05-20</td>
                            <td>2024-12-15</td>
                            <td>
                                <button class="btn btn-primary" onclick="showInspection()" style="margin-right: 5px;">점검</button>
                                <button class="btn btn-secondary" onclick="startNavigation('강남구청', '37.5172363', '127.0473248')" style="font-size: 12px;">길안내</button>
                            </td>
                        </tr>
                        <tr>
                            <td>서초구 보건소</td>
                            <td>13-0000234</td>
                            <td><span class="badge badge-warning">주의</span></td>
                            <td>2025-03-10</td>
                            <td>2025-01-20</td>
                            <td>2034-02-10</td>
                            <td>2024-12-20</td>
                            <td>
                                <button class="btn btn-primary" onclick="showInspection()" style="margin-right: 5px;">점검</button>
                                <button class="btn btn-secondary" onclick="startNavigation('서초구 보건소', '37.4837121', '127.0324112')" style="font-size: 12px;">길안내</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 점검 관리 페이지 -->
        <div id="inspection" class="page-section active">
            <h1 style="margin-bottom: 20px;">점검 관리</h1>
            
            <!-- 스케줄 상태 표시 -->
            <div id="scheduleStatus" style="background: #1a3a52; padding: 15px; border-radius: 8px; margin-bottom: 20px; border: 1px solid #2a4a62;">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 24px;">📅</span>
                    <div>
                        <h3 style="margin: 0; color: #10b981;">오늘의 점검 스케줄 (12건)</h3>
                        <p style="margin: 5px 0 0 0; color: #888; font-size: 14px;">설정된 스케줄에 따른 점검 대상</p>
                    </div>
                </div>
            </div>

            <!-- 검색 모드 탭 -->
            <div style="display: flex; gap: 10px; margin-bottom: 20px; background: #1a1a1a; padding: 15px; border-radius: 8px;">
                <button class="btn btn-primary" onclick="showSearchMode('priority')" id="searchPriority">우선순위</button>
                <button class="btn btn-secondary" onclick="showSearchMode('name')" id="searchName">기관명</button>
                <button class="btn btn-secondary" onclick="showSearchMode('serial')" id="searchSerial">장비연번</button>
                <button class="btn btn-secondary" onclick="showSearchMode('gps')" id="searchGPS">📍 가까운 장비</button>
            </div>

            <!-- 검색 입력 영역 -->
            <div id="searchInputArea" style="margin-bottom: 20px; display: none;">
                <div class="search-bar">
                    <input type="text" id="searchInput" class="search-input" placeholder="검색어를 입력하세요...">
                    <button class="btn btn-primary" onclick="performSearch()">검색</button>
                </div>
            </div>

            <!-- 필터 옵션 -->
            <div style="display: flex; gap: 15px; margin-bottom: 20px; padding: 10px; background: #1a1a1a; border-radius: 8px;">
                <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                    <input type="checkbox" checked onchange="updateInspectionList()"> 
                    <span style="color: #888;">미점검 장비만</span>
                </label>
                <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                    <input type="checkbox" onchange="toggleScheduleMode()">
                    <span style="color: #888;">추천 대상 포함</span>
                </label>
            </div>

            <!-- 점검 대상 리스트 -->
            <div class="data-table">
                <div class="table-header">
                    <h2 class="table-title">점검 대상 목록</h2>
                </div>
                <div id="inspectionList" style="display: flex; flex-direction: column; gap: 15px; padding: 20px;">
                    <!-- 스케줄된 점검 항목 1 -->
                    <div class="inspection-card" style="background: #1a1a1a; padding: 20px; border-radius: 8px; border-left: 4px solid #e74c3c;">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                            <div>
                                <span style="background: #e74c3c; color: white; padding: 2px 8px; border-radius: 4px; font-size: 12px;">09:00</span>
                                <h3 style="margin: 10px 0 5px 0; color: #fff;">서울시청 본관</h3>
                                <p style="color: #888; font-size: 14px;">장비연번: 13-0000042</p>
                            </div>
                            <div style="text-align: right;">
                                <span class="badge badge-danger">배터리 D-5</span>
                            </div>
                        </div>
                        <div style="color: #666; font-size: 14px; margin-bottom: 15px;">
                            예정 점검: 정기점검, 배터리 확인
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-primary" onclick="startInspection('13-0000042')" style="flex: 1;">점검 시작</button>
                            <button class="btn btn-secondary" onclick="startNavigation('서울시청', '37.5662952', '126.9779451')">길안내</button>
                        </div>
                    </div>

                    <!-- 스케줄된 점검 항목 2 -->
                    <div class="inspection-card" style="background: #1a1a1a; padding: 20px; border-radius: 8px; border-left: 4px solid #f39c12;">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                            <div>
                                <span style="background: #f39c12; color: white; padding: 2px 8px; border-radius: 4px; font-size: 12px;">10:30</span>
                                <h3 style="margin: 10px 0 5px 0; color: #fff;">강남구청</h3>
                                <p style="color: #888; font-size: 14px;">장비연번: 13-0000156</p>
                            </div>
                            <div style="text-align: right;">
                                <span class="badge badge-warning">패드 D-25</span>
                            </div>
                        </div>
                        <div style="color: #666; font-size: 14px; margin-bottom: 15px;">
                            예정 점검: 패드 교체 확인
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-primary" onclick="startInspection('13-0000156')" style="flex: 1;">점검 시작</button>
                            <button class="btn btn-secondary" onclick="startNavigation('강남구청', '37.5172363', '127.0473248')">길안내</button>
                        </div>
                    </div>

                    <!-- 스케줄된 점검 항목 3 -->
                    <div class="inspection-card" style="background: #1a1a1a; padding: 20px; border-radius: 8px; border-left: 4px solid #3498db;">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                            <div>
                                <span style="background: #3498db; color: white; padding: 2px 8px; border-radius: 4px; font-size: 12px;">14:00</span>
                                <h3 style="margin: 10px 0 5px 0; color: #fff;">서초구 보건소</h3>
                                <p style="color: #888; font-size: 14px;">장비연번: 13-0000234</p>
                            </div>
                            <div style="text-align: right;">
                                <span class="badge badge-info">정기점검</span>
                            </div>
                        </div>
                        <div style="color: #666; font-size: 14px; margin-bottom: 15px;">
                            예정 점검: 월간 정기점검
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-primary" onclick="startInspection('13-0000234')" style="flex: 1;">점검 시작</button>
                            <button class="btn btn-secondary" onclick="startNavigation('서초구 보건소', '37.4837121', '127.0324112')">길안내</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 기존 점검 테이블 삭제하고 새로운 형식으로 -->
        <div id="inspectionHistory" class="page-section" style="display: none;">
            <h1 style="margin-bottom: 30px;">점검 이력</h1>
            <div class="data-table">
                <div class="table-header">
                    <h2 class="table-title">최근 점검 이력</h2>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>점검일</th>
                            <th>장비연번</th>
                            <th>설치기관명</th>
                            <th>점검자</th>
                            <th>배터리상태</th>
                            <th>패드상태</th>
                            <th>장비상태</th>
                            <th>상세</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>2025-01-07 14:30</td>
                            <td>13-0000089</td>
                            <td>종로구청</td>
                            <td>김점검</td>
                            <td><span class="badge badge-success">정상</span></td>
                            <td><span class="badge badge-success">정상</span></td>
                            <td><span class="badge badge-success">정상</span></td>
                            <td><button class="btn btn-secondary">보기</button></td>
                        </tr>
                        <tr>
                            <td>2025-01-07 11:20</td>
                            <td>13-0000145</td>
                            <td>중구 보건소</td>
                            <td>이점검</td>
                            <td><span class="badge badge-warning">교체임박</span></td>
                            <td><span class="badge badge-success">정상</span></td>
                            <td><span class="badge badge-success">정상</span></td>
                            <td><button class="btn btn-secondary">보기</button></td>
                        </tr>
                        <tr>
                            <td>2025-01-06 16:45</td>
                            <td>13-0000201</td>
                            <td>용산구청</td>
                            <td>박점검</td>
                            <td><span class="badge badge-success">정상</span></td>
                            <td><span class="badge badge-success">정상</span></td>
                            <td><span class="badge badge-success">정상</span></td>
                            <td><button class="btn btn-secondary">보기</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 장비 관리 페이지 -->
        <div id="devices" class="page-section">
            <h1 style="margin-bottom: 30px;">장비 관리</h1>
            
            <div class="search-bar">
                <input type="text" class="search-input" placeholder="장치 검색...">
                <select class="search-input" style="width: 200px;">
                    <option>전체 상태</option>
                    <option>정상</option>
                    <option>점검 필요</option>
                    <option>만료</option>
                </select>
                <button class="btn btn-primary">필터 적용</button>
            </div>

            <div class="dashboard-grid">
                <div class="stat-card">
                    <div class="stat-label">정상 작동</div>
                    <div class="stat-value" style="color: #44ff44;">267</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">점검 필요</div>
                    <div class="stat-value" style="color: #ffaa00;">42</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">교체 필요</div>
                    <div class="stat-value" style="color: #ff4444;">18</div>
                </div>
            </div>

            <div class="data-table">
                <div class="table-header">
                    <h2 class="table-title">전체 장비 목록</h2>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>장비연번</th>
                            <th>설치기관명</th>
                            <th>모델명</th>
                            <th>제조일</th>
                            <th>배터리유효기간</th>
                            <th>패드유효기간</th>
                            <th>장비유효기간</th>
                            <th>최근점검일자</th>
                            <th>상태</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>13-0000001</td>
                            <td>서울시청</td>
                            <td>HeartStart FRx</td>
                            <td>2024-01-15</td>
                            <td>2026-01-15</td>
                            <td>2025-07-15</td>
                            <td>2034-01-15</td>
                            <td>2025-01-05</td>
                            <td><span class="badge badge-success">정상</span></td>
                        </tr>
                        <tr>
                            <td>13-0000002</td>
                            <td>강남구청</td>
                            <td>ZOLL AED Plus</td>
                            <td>2024-02-20</td>
                            <td>2025-02-20</td>
                            <td>2025-01-30</td>
                            <td>2034-02-20</td>
                            <td>2024-12-28</td>
                            <td><span class="badge badge-warning">주의</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 우선순위 관리 페이지 -->
        <div id="priority" class="page-section">
            <h1 style="margin-bottom: 30px;">우선순위 관리</h1>
            
            <div class="dashboard-grid">
                <div class="stat-card danger">
                    <div class="stat-label">긴급 (24시간 내)</div>
                    <div class="stat-value">8</div>
                </div>
                <div class="stat-card warning">
                    <div class="stat-label">높음 (3일 내)</div>
                    <div class="stat-value">15</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">보통 (7일 내)</div>
                    <div class="stat-value">32</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">낮음 (30일 내)</div>
                    <div class="stat-value">89</div>
                </div>
            </div>

            <div class="data-table">
                <div class="table-header">
                    <h2 class="table-title">우선순위별 점검 대상</h2>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>우선순위</th>
                            <th>장비연번</th>
                            <th>설치기관명</th>
                            <th>사유</th>
                            <th>배터리만료</th>
                            <th>패드만료</th>
                            <th>최근점검</th>
                            <th>처리기한</th>
                            <th>담당자</th>
                            <th>작업</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="background: rgba(255,68,68,0.1);">
                            <td><span class="badge badge-danger">긴급</span></td>
                            <td>13-0000042</td>
                            <td>서울시청</td>
                            <td>배터리 만료</td>
                            <td>2024-12-31</td>
                            <td>2025-03-15</td>
                            <td>2024-12-01</td>
                            <td>2025-01-08</td>
                            <td>
                                <select class="search-input" style="width: 100px; padding: 5px;" onchange="assignTeamMember(this, '13-0000042')">
                                    <option value="">미배정</option>
                                    <option value="김점검">김점검</option>
                                    <option value="이점검">이점검</option>
                                    <option value="박점검">박점검</option>
                                    <option value="최점검">최점검</option>
                                </select>
                            </td>
                            <td>
                                <button class="btn btn-primary" onclick="showInspection()" style="font-size: 12px; padding: 5px 10px;">점검</button>
                                <button class="btn btn-secondary" onclick="startNavigation('서울시청', '37.5662952', '126.9779451')" style="font-size: 12px; padding: 5px 10px;">길안내</button>
                            </td>
                        </tr>
                        <tr style="background: rgba(255,68,68,0.1);">
                            <td><span class="badge badge-danger">긴급</span></td>
                            <td>13-0000156</td>
                            <td>강남구청</td>
                            <td>패드 만료 임박</td>
                            <td>2025-02-20</td>
                            <td>2025-01-15</td>
                            <td>2024-12-15</td>
                            <td>2025-01-08</td>
                            <td>
                                <select class="search-input" style="width: 100px; padding: 5px;" onchange="assignTeamMember(this, '13-0000156')">
                                    <option value="김점검" selected>김점검</option>
                                    <option value="이점검">이점검</option>
                                    <option value="박점검">박점검</option>
                                    <option value="최점검">최점검</option>
                                    <option value="">미배정</option>
                                </select>
                            </td>
                            <td>
                                <button class="btn btn-primary" onclick="showInspection()" style="font-size: 12px; padding: 5px 10px;">점검</button>
                                <button class="btn btn-secondary" onclick="startNavigation('강남구청', '37.5172363', '127.0473248')" style="font-size: 12px; padding: 5px 10px;">길안내</button>
                            </td>
                        </tr>
                        <tr style="background: rgba(255,170,0,0.1);">
                            <td><span class="badge badge-warning">높음</span></td>
                            <td>13-0000234</td>
                            <td>서초구 보건소</td>
                            <td>정기점검 지연</td>
                            <td>2025-03-10</td>
                            <td>2025-01-20</td>
                            <td>2024-11-20</td>
                            <td>2025-01-10</td>
                            <td>
                                <select class="search-input" style="width: 100px; padding: 5px;" onchange="assignTeamMember(this, '13-0000234')">
                                    <option value="이점검" selected>이점검</option>
                                    <option value="김점검">김점검</option>
                                    <option value="박점검">박점검</option>
                                    <option value="최점검">최점검</option>
                                    <option value="">미배정</option>
                                </select>
                            </td>
                            <td>
                                <button class="btn btn-primary" onclick="showInspection()" style="font-size: 12px; padding: 5px 10px;">점검</button>
                                <button class="btn btn-secondary" onclick="startNavigation('서초구 보건소', '37.4837121', '127.0324112')" style="font-size: 12px; padding: 5px 10px;">길안내</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 팀 협업 페이지 -->
        <div id="team" class="page-section">
            <h1 style="margin-bottom: 30px;">팀 협업</h1>
            
            <div class="dashboard-grid">
                <div class="stat-card">
                    <div class="stat-label">활동 중인 팀원</div>
                    <div class="stat-value">12</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">오늘 점검 완료</div>
                    <div class="stat-value">34</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">평균 처리 시간</div>
                    <div class="stat-value">18분</div>
                </div>
            </div>

            <div class="data-table">
                <div class="table-header" style="display: flex; justify-content: space-between; align-items: center;">
                    <h2 class="table-title">팀원 현황</h2>
                    <button class="btn btn-primary" onclick="showAddMemberModal()">팀원 추가</button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>이름</th>
                            <th>소속</th>
                            <th>오늘 할당량</th>
                            <th>완료</th>
                            <th>진행률</th>
                            <th>작업</th>
                        </tr>
                    </thead>
                    <tbody id="teamMembersList">
                        <tr>
                            <td>김점검</td>
                            <td>종로구 보건소</td>
                            <td>15</td>
                            <td>8</td>
                            <td><div style="background: #333; border-radius: 4px; overflow: hidden; height: 20px;"><div style="background: #10b981; height: 100%; width: 53%;"></div></div></td>
                            <td><button class="btn btn-secondary" onclick="showMemberDetails('김점검', 15, 8)">상세보기</button></td>
                        </tr>
                        <tr>
                            <td>이점검</td>
                            <td>중구 보건소</td>
                            <td>12</td>
                            <td>6</td>
                            <td><div style="background: #333; border-radius: 4px; overflow: hidden; height: 20px;"><div style="background: #10b981; height: 100%; width: 50%;"></div></div></td>
                            <td><button class="btn btn-secondary" onclick="showMemberDetails('이점검', 12, 6)">상세보기</button></td>
                        </tr>
                        <tr>
                            <td>박점검</td>
                            <td>용산구 보건소</td>
                            <td>10</td>
                            <td>5</td>
                            <td><div style="background: #333; border-radius: 4px; overflow: hidden; height: 20px;"><div style="background: #10b981; height: 100%; width: 50%;"></div></div></td>
                            <td><button class="btn btn-secondary" onclick="showMemberDetails('박점검', 10, 5)">상세보기</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 보고서 페이지 -->
        <div id="reports" class="page-section">
            <h1 style="margin-bottom: 30px;">보고서</h1>
            
            <div class="dashboard-grid">
                <div class="stat-card">
                    <div class="stat-label">월간 점검률</div>
                    <div class="stat-value">92%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">평균 응답시간</div>
                    <div class="stat-value">4.2시간</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">정시 점검률</div>
                    <div class="stat-value">87%</div>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                <button class="btn btn-primary" style="padding: 20px;">
                    월간 보고서 생성
                </button>
                <button class="btn btn-primary" style="padding: 20px;">
                    분기별 보고서 생성
                </button>
                <button class="btn btn-primary" style="padding: 20px;">
                    연간 보고서 생성
                </button>
                <button class="btn btn-primary" style="padding: 20px;">
                    맞춤 보고서 생성
                </button>
            </div>

            <div class="data-table" style="margin-top: 30px;">
                <div class="table-header">
                    <h2 class="table-title">최근 생성된 보고서</h2>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>보고서명</th>
                            <th>기간</th>
                            <th>생성일</th>
                            <th>생성자</th>
                            <th>다운로드</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>2024년 12월 월간 보고서</td>
                            <td>2024.12.01 - 2024.12.31</td>
                            <td>2025.01.02</td>
                            <td>관리자</td>
                            <td><button class="btn btn-secondary">PDF</button></td>
                        </tr>
                        <tr>
                            <td>2024년 4분기 보고서</td>
                            <td>2024.10.01 - 2024.12.31</td>
                            <td>2025.01.05</td>
                            <td>관리자</td>
                            <td><button class="btn btn-secondary">PDF</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 설정 페이지 -->
        <div id="settings" class="page-section">
            <h1 style="margin-bottom: 30px;">설정</h1>
            
            <div style="display: grid; gap: 20px; max-width: 600px;">
                <div style="background: #1a1a1a; padding: 20px; border-radius: 12px; border: 1px solid #333;">
                    <h3 style="margin-bottom: 15px;">알림 설정</h3>
                    <div style="display: grid; gap: 10px;">
                        <label style="display: flex; align-items: center; gap: 10px;">
                            <input type="checkbox" checked> 긴급 점검 알림
                        </label>
                        <label style="display: flex; align-items: center; gap: 10px;">
                            <input type="checkbox" checked> 만료 임박 알림
                        </label>
                        <label style="display: flex; align-items: center; gap: 10px;">
                            <input type="checkbox"> 일일 요약 보고
                        </label>
                    </div>
                </div>

                <div style="background: #1a1a1a; padding: 20px; border-radius: 12px; border: 1px solid #333;">
                    <h3 style="margin-bottom: 15px;">계정 정보</h3>
                    <div style="display: grid; gap: 10px;">
                        <div>
                            <label style="color: #888; font-size: 14px;">이름</label>
                            <input type="text" class="search-input" value="홍길동" style="width: 100%; margin-top: 5px;">
                        </div>
                        <div>
                            <label style="color: #888; font-size: 14px;">이메일</label>
                            <input type="email" class="search-input" value="hong@korea.kr" style="width: 100%; margin-top: 5px;">
                        </div>
                        <div>
                            <label style="color: #888; font-size: 14px;">소속</label>
                            <input type="text" class="search-input" value="서울시 종로구 보건소" style="width: 100%; margin-top: 5px;">
                        </div>
                    </div>
                    <button class="btn btn-primary" style="margin-top: 15px;">정보 수정</button>
                </div>

                <div style="background: #1a1a1a; padding: 20px; border-radius: 12px; border: 1px solid #333;">
                    <h3 style="margin-bottom: 15px;">보안 설정</h3>
                    <button class="btn btn-secondary" style="width: 100%; margin-bottom: 10px;">비밀번호 변경</button>
                    <button class="btn btn-secondary" style="width: 100%;">2단계 인증 설정</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 모바일 메뉴 버튼 -->
    <button class="mobile-menu-btn" onclick="toggleMobileMenu()">☰</button>

    <!-- 플로팅 액션 버튼 (도움말) -->
    <div class="fab" onclick="showTutorial()">?</div>

    <!-- 빠른 액션 바 -->
    <div class="quick-actions">
        <button class="quick-action-btn" onclick="showPage('dashboard')" title="대시보드">□</button>
        <button class="quick-action-btn" onclick="startNewInspection()" title="새 점검">+</button>
        <button class="quick-action-btn" onclick="showNotifications()" title="알림">○</button>
        <button class="quick-action-btn" onclick="showSearch()" title="검색">◎</button>
        <button class="quick-action-btn" onclick="showPage('reports')" title="보고서">▥</button>
    </div>

    <!-- 점검 모달 -->
    <div id="inspectionModal" class="tutorial-overlay" style="display: none;">
        <div class="tutorial-modal" style="max-width: 900px; height: 90vh; display: flex; flex-direction: column;">
            <!-- 고정 헤더 -->
            <div style="background: #1a1a1a; padding: 20px; border-bottom: 2px solid #333; z-index: 100; flex-shrink: 0;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h2 style="color: #10b981; font-size: 24px; font-weight: 700; margin: 0;">AED 점검 화면</h2>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-secondary" onclick="closeInspectionModal()">
                            <span style="margin-right: 5px;">←</span> 목록으로
                        </button>
                        <button class="btn btn-success" onclick="saveInspection()" style="min-width: 120px;">
                            <span style="margin-right: 5px;">✓</span> 점검 완료
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- 스크롤 가능한 콘텐츠 영역 -->
            <div style="flex: 1; overflow-y: auto; padding: 20px; background: #1a1a1a;">
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                <div>
                    <label style="color: #888; font-size: 14px;">장비연번</label>
                    <input type="text" class="search-input" value="13-0000042" readonly style="width: 100%; margin-top: 5px;">
                </div>
                <div>
                    <label style="color: #888; font-size: 14px;">설치기관명</label>
                    <input type="text" class="search-input" value="서울시청" readonly style="width: 100%; margin-top: 5px;">
                </div>
            </div>

            <div style="background: #111; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="color: #10b981; margin-bottom: 15px;">점검 항목</h3>
                
                <div style="margin-bottom: 15px;">
                    <h4 style="color: #e0e0e0; margin-bottom: 10px;">1. 외관 상태</h4>
                    <label style="display: inline-block; margin-right: 20px; color: #e0e0e0;">
                        <input type="radio" name="exterior" value="good" checked> 양호
                    </label>
                    <label style="display: inline-block; margin-right: 20px; color: #e0e0e0;">
                        <input type="radio" name="exterior" value="damage"> 파손
                    </label>
                    <label style="display: inline-block; color: #e0e0e0;">
                        <input type="radio" name="exterior" value="contamination"> 오염
                    </label>
                </div>

                <div style="margin-bottom: 20px; padding: 15px; background: #0a0a0a; border-radius: 8px;">
                    <h4 style="color: #e0e0e0; margin-bottom: 15px;">2. 배터리 유효기간</h4>
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 10px;">
                        <span style="color: #888;">DB 등록 정보:</span>
                        <span style="color: #10b981; font-weight: bold;">2024-12-31</span>
                        <span style="color: #e74c3c;">(D-5)</span>
                    </div>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <button class="btn btn-primary" onclick="confirmDate('battery')" id="batteryConfirm">일치</button>
                        <button class="btn btn-secondary" onclick="showDateEdit('battery')" id="batteryEdit">수정</button>
                        <div id="batteryEditArea" style="display: none; flex: 1;">
                            <input type="date" id="batteryDate" class="search-input" style="width: 200px;">
                            <button class="btn btn-success" onclick="saveDate('battery')" style="margin-left: 10px;">저장</button>
                        </div>
                    </div>
                </div>

                <div style="margin-bottom: 20px; padding: 15px; background: #0a0a0a; border-radius: 8px;">
                    <h4 style="color: #e0e0e0; margin-bottom: 15px;">3. 패드 유효기간</h4>
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 10px;">
                        <span style="color: #888;">DB 등록 정보:</span>
                        <span style="color: #10b981; font-weight: bold;">2025-03-15</span>
                        <span style="color: #f39c12;">(D-68)</span>
                    </div>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <button class="btn btn-primary" onclick="confirmDate('pad')" id="padConfirm">일치</button>
                        <button class="btn btn-secondary" onclick="showDateEdit('pad')" id="padEdit">수정</button>
                        <div id="padEditArea" style="display: none; flex: 1;">
                            <input type="date" id="padDate" class="search-input" style="width: 200px;">
                            <button class="btn btn-success" onclick="saveDate('pad')" style="margin-left: 10px;">저장</button>
                        </div>
                    </div>
                </div>

                <div style="margin-bottom: 20px; padding: 15px; background: #0a0a0a; border-radius: 8px;">
                    <h4 style="color: #e0e0e0; margin-bottom: 15px;">4. 장비 유효기간</h4>
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 10px;">
                        <span style="color: #888;">DB 등록 정보:</span>
                        <span style="color: #10b981; font-weight: bold;">2032-01-15</span>
                        <span style="color: #27ae60;">(D-2565)</span>
                    </div>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <button class="btn btn-primary" onclick="confirmDate('device')" id="deviceConfirm">일치</button>
                        <button class="btn btn-secondary" onclick="showDateEdit('device')" id="deviceEdit">수정</button>
                        <div id="deviceEditArea" style="display: none; flex: 1;">
                            <input type="date" id="deviceDate" class="search-input" style="width: 200px;">
                            <button class="btn btn-success" onclick="saveDate('device')" style="margin-left: 10px;">저장</button>
                        </div>
                    </div>
                </div>


                <div style="margin-bottom: 15px;">
                    <h4 style="color: #e0e0e0; margin-bottom: 10px;">5. 작동 상태</h4>
                    <label style="display: inline-block; margin-right: 20px; color: #e0e0e0;">
                        <input type="radio" name="operation" value="good" checked> 정상작동
                    </label>
                    <label style="display: inline-block; margin-right: 20px; color: #e0e0e0;">
                        <input type="radio" name="operation" value="error"> 오류발생
                    </label>
                    <label style="display: inline-block; color: #e0e0e0;">
                        <input type="radio" name="operation" value="malfunction"> 작동불가
                    </label>
                </div>

                <div style="margin-bottom: 15px;">
                    <h4 style="color: #e0e0e0; margin-bottom: 10px;">6. 표시등 상태</h4>
                    <label style="display: inline-block; margin-right: 20px; color: #e0e0e0;">
                        <input type="radio" name="indicator" value="green" checked> 녹색 (정상)
                    </label>
                    <label style="display: inline-block; margin-right: 20px; color: #e0e0e0;">
                        <input type="radio" name="indicator" value="yellow"> 황색 (주의)
                    </label>
                    <label style="display: inline-block; color: #e0e0e0;">
                        <input type="radio" name="indicator" value="red"> 적색 (이상)
                    </label>
                </div>

                <div style="margin-bottom: 20px; padding: 15px; background: #0a0a0a; border-radius: 8px;">
                    <h4 style="color: #e0e0e0; margin-bottom: 15px;">7. 운영시간</h4>
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 10px;">
                        <span style="color: #888;">DB 등록 정보:</span>
                        <span style="color: #10b981; font-weight: bold;">24시간 운영</span>
                    </div>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <button class="btn btn-primary" onclick="confirmOperatingHours()" id="hoursConfirm">일치</button>
                        <button class="btn btn-secondary" onclick="showHoursEdit()" id="hoursEdit">수정</button>
                        <div id="hoursEditArea" style="display: none; flex: 1;">
                            <select id="hoursType" class="search-input" style="width: 200px;" onchange="toggleCustomHours()">
                                <option value="24h">24시간</option>
                                <option value="office">평일 업무시간 (09:00-18:00)</option>
                                <option value="custom">직접 입력</option>
                            </select>
                            <div id="customHoursArea" style="display: none; margin-top: 10px;">
                                <input type="time" id="openTime" class="search-input" style="width: 100px;"> ~ 
                                <input type="time" id="closeTime" class="search-input" style="width: 100px;">
                            </div>
                            <button class="btn btn-success" onclick="saveHours()" style="margin-left: 10px;">저장</button>
                        </div>
                    </div>
                </div>

                <div style="margin-bottom: 20px; padding: 15px; background: #0a0a0a; border-radius: 8px;">
                    <h4 style="color: #e0e0e0; margin-bottom: 15px;">8. 설치 위치</h4>
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 10px;">
                        <span style="color: #888;">현재 위치:</span>
                        <span style="color: #10b981; font-weight: bold;" id="locationDesc">서울시청 본관 1층 로비</span>
                    </div>
                    
                    <!-- 카카오 지도 컨테이너 -->
                    <div style="position: relative; margin-bottom: 10px;">
                        <div id="kakaoMapContainer" style="width: 100%; height: 400px; border-radius: 8px; position: relative; background: #f0f0f0; border: 1px solid #333;">
                            <div id="mapLoading" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #666; font-size: 14px;">
                                지도를 불러오는 중...
                            </div>
                        </div>
                        
                        <!-- 좌표 표시 -->
                        <div style="position: absolute; bottom: 10px; left: 10px; background: rgba(0,0,0,0.8); padding: 8px 12px; border-radius: 4px; z-index: 2;">
                            <p style="color: #fff; margin: 0; font-size: 12px; font-weight: 500;">위도: <span id="latDisplay">37.5662952</span></p>
                            <p style="color: #fff; margin: 0; font-size: 12px; font-weight: 500;">경도: <span id="lngDisplay">126.9779451</span></p>
                        </div>
                        
                        <!-- 수정 모드 안내 -->
                        <div id="mapEditHint" style="position: absolute; top: 10px; right: 10px; background: linear-gradient(135deg, #f39c12, #e67e22); padding: 8px 12px; border-radius: 4px; display: none; z-index: 2; box-shadow: 0 2px 8px rgba(0,0,0,0.3);">
                            <p style="color: #fff; margin: 0; font-size: 12px; font-weight: 500;">지도를 클릭하거나 마커를 드래그하여 위치 수정</p>
                        </div>
                    </div>
                    
                    <!-- 버튼 그룹 -->
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button class="btn btn-primary" onclick="confirmLocation()" id="locationConfirm" style="flex: 1; min-width: 120px;">
                            <span style="margin-right: 5px;">✓</span> 위치 확인
                        </button>
                        <button class="btn btn-secondary" onclick="enableLocationEdit()" id="locationEdit" style="flex: 1; min-width: 120px;">
                            <span style="margin-right: 5px;">✎</span> 위치 수정
                        </button>
                        <button class="btn btn-info" onclick="getCurrentLocation()" style="display: none; flex: 1; min-width: 120px;" id="locationGPS">
                            <span style="margin-right: 5px;">📍</span> 현재 위치
                        </button>
                        <button class="btn btn-success" onclick="saveLocation()" style="display: none; flex: 1; min-width: 120px;" id="locationSave">
                            <span style="margin-right: 5px;">💾</span> 위치 저장
                        </button>
                    </div>
                </div>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="color: #888; font-size: 14px;">점검 메모</label>
                <textarea class="search-input" style="width: 100%; margin-top: 5px; height: 80px; resize: vertical;" placeholder="특이사항을 입력하세요..."></textarea>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="color: #888; font-size: 14px;">사진 첨부</label>
                <div style="border: 2px dashed #333; border-radius: 8px; padding: 20px; text-align: center; margin-top: 5px;">
                    <button class="btn btn-secondary">사진 선택</button>
                    <p style="color: #666; margin-top: 10px; font-size: 14px;">또는 여기에 파일을 드래그하세요</p>
                </div>
            </div>

            <div style="display: flex; justify-content: space-between;">
                <button class="btn btn-secondary" onclick="closeInspectionModal()">취소</button>
                <button class="btn btn-primary" onclick="saveInspection()">점검 완료</button>
            </div>
        </div>
    </div>

    <!-- 알림 센터 -->
    <div id="notificationCenter" class="notification-center">
        <div class="notification-header">
            <span style="font-weight: 600;">알림</span>
            <button onclick="closeNotifications()" style="background: none; border: none; color: #888; cursor: pointer;">×</button>
        </div>
        <div class="notification-list">
            <div class="notification-item" onclick="showAlert('알림 상세 보기')">
                <div style="color: #ff4444; font-weight: 600;">긴급 점검 필요</div>
                <div style="color: #e0e0e0; font-size: 14px; margin-top: 5px;">서울시청 1층 AED 패드 만료</div>
                <div class="notification-time">5분 전</div>
            </div>
            <div class="notification-item" onclick="showAlert('알림 상세 보기')">
                <div style="color: #ffaa00; font-weight: 600;">점검 완료</div>
                <div style="color: #e0e0e0; font-size: 14px; margin-top: 5px;">김점검님이 3건의 점검을 완료했습니다</div>
                <div class="notification-time">15분 전</div>
            </div>
            <div class="notification-item" onclick="showAlert('알림 상세 보기')">
                <div style="color: #10b981; font-weight: 600;">시스템 알림</div>
                <div style="color: #e0e0e0; font-size: 14px; margin-top: 5px;">월간 보고서가 생성되었습니다</div>
                <div class="notification-time">1시간 전</div>
            </div>
        </div>
    </div>

    <!-- 튜토리얼 오버레이 -->
    <div id="tutorialOverlay" class="tutorial-overlay" style="display: none;">
        <div class="tutorial-modal">
            <h2 class="tutorial-title">AED 스마트 점검 시스템 튜토리얼</h2>
            <div class="tutorial-content">
                <p>이 시스템은 전국 AED 장비를 효율적으로 관리하고 점검하기 위한 통합 플랫폼입니다.</p>
                <br>
                <p><strong>주요 기능:</strong></p>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li>실시간 장비 상태 모니터링</li>
                    <li>우선순위 기반 점검 관리</li>
                    <li>팀 협업 및 작업 분배</li>
                    <li>자동 보고서 생성</li>
                </ul>
                <br>
                <p>왼쪽 메뉴를 클릭하여 각 기능을 체험해보세요!</p>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" style="width: 30%;"></div>
            </div>
            <div style="display: flex; justify-content: space-between; margin-top: 20px;">
                <button class="btn btn-secondary" onclick="closeTutorial()">건너뛰기</button>
                <button class="btn btn-primary" onclick="nextTutorialStep()">다음</button>
            </div>
        </div>
    </div>

    <script>
        // 페이지 전환 함수
        function showPage(pageId) {
            // 모든 페이지 숨기기
            const pages = document.querySelectorAll('.page-section');
            pages.forEach(page => page.classList.remove('active'));
            
            // 모든 메뉴 아이템 비활성화
            const menuItems = document.querySelectorAll('.menu-item');
            menuItems.forEach(item => item.classList.remove('active'));
            
            // 선택된 페이지 표시
            document.getElementById(pageId).classList.add('active');
            
            // 선택된 메뉴 아이템 활성화
            event.currentTarget.classList.add('active');
        }

        // 점검 시작 함수
        function startNewInspection() {
            document.getElementById('inspectionModal').style.display = 'flex';
        }

        // 점검 상세 보기
        function showInspection() {
            document.getElementById('inspectionModal').style.display = 'flex';
        }

        // 점검 모달 닫기
        function closeInspectionModal() {
            document.getElementById('inspectionModal').style.display = 'none';
        }

        // 날짜 확인 버튼
        function confirmDate(type) {
            const confirmBtn = document.getElementById(type + 'Confirm');
            confirmBtn.textContent = '확인됨';
            confirmBtn.className = 'btn btn-success';
            confirmBtn.disabled = true;
            
            // 수정 버튼 비활성화
            document.getElementById(type + 'Edit').style.display = 'none';
        }

        // 날짜 수정 모드 표시
        function showDateEdit(type) {
            const editArea = document.getElementById(type + 'EditArea');
            editArea.style.display = 'flex';
            
            // 일치/수정 버튼 숨기기
            document.getElementById(type + 'Confirm').style.display = 'none';
            document.getElementById(type + 'Edit').style.display = 'none';
            
            // 현재 날짜 설정
            const today = new Date().toISOString().split('T')[0];
            document.getElementById(type + 'Date').value = today;
        }

        // 날짜 저장
        function saveDate(type) {
            const newDate = document.getElementById(type + 'Date').value;
            if (!newDate) {
                showAlert('날짜를 선택해주세요');
                return;
            }
            
            // 날짜 표시 업데이트
            const editArea = document.getElementById(type + 'EditArea');
            editArea.style.display = 'none';
            
            // 수정됨 표시
            const confirmBtn = document.getElementById(type + 'Confirm');
            confirmBtn.textContent = '수정됨';
            confirmBtn.className = 'btn btn-warning';
            confirmBtn.style.display = 'inline-block';
            confirmBtn.disabled = true;
            
            showAlert(`${type === 'battery' ? '배터리' : type === 'pad' ? '패드' : '장비'} 유효기간이 ${newDate}로 수정되었습니다`);
        }

        // 점검 저장
        function saveInspection() {
            // 유효기간 확인 상태 체크
            const batteryStatus = document.getElementById('batteryConfirm').textContent;
            const padStatus = document.getElementById('padConfirm').textContent;
            const deviceStatus = document.getElementById('deviceConfirm').textContent;
            
            // 하나라도 확인/수정되지 않은 경우
            if (batteryStatus === '일치' || padStatus === '일치' || deviceStatus === '일치') {
                showAlert('모든 유효기간을 확인 또는 수정해주세요');
                return;
            }
            
            // 선택된 값들 수집
            const exterior = document.querySelector('input[name="exterior"]:checked').value;
            const operation = document.querySelector('input[name="operation"]:checked').value;
            const indicator = document.querySelector('input[name="indicator"]:checked').value;
            
            showAlert('점검이 성공적으로 저장되었습니다.');
            closeInspectionModal();
            
            // 점검 완료 카드 업데이트 (시각적 피드백)
            setTimeout(() => {
                showAlert('다음 점검 대상으로 이동합니다');
                // 실제로는 리스트에서 완료된 항목 제거하고 다음 항목 표시
            }, 1000);
        }

        // 네비게이션 시작
        function startNavigation(placeName, lat, lng) {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 2500;
            `;
            modal.innerHTML = `
                <div style="background: #1a1a1a; border: 1px solid #333; border-radius: 12px; padding: 30px; max-width: 400px;">
                    <h3 style="color: #10b981; margin-bottom: 20px;">길안내 앱 선택</h3>
                    <p style="color: #e0e0e0; margin-bottom: 20px;">목적지: ${placeName}</p>
                    <div style="display: grid; gap: 10px;">
                        <button class="btn btn-primary" style="width: 100%;" onclick="openTmap('${placeName}', '${lat}', '${lng}')">티맵으로 안내</button>
                        <button class="btn btn-primary" style="width: 100%;" onclick="openKakaoNavi('${placeName}', '${lat}', '${lng}')">카카오내비로 안내</button>
                        <button class="btn btn-primary" style="width: 100%;" onclick="openNaverMap('${placeName}', '${lat}', '${lng}')">네이버지도로 안내</button>
                        <button class="btn btn-secondary" style="width: 100%; margin-top: 10px;" onclick="this.parentElement.parentElement.parentElement.remove()">취소</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        // 티맵 열기
        function openTmap(name, lat, lng) {
            const url = `tmap://route?goalname=${encodeURIComponent(name)}&goalx=${lng}&goaly=${lat}`;
            window.open(url, '_blank');
            showAlert('티맵이 실행되지 않으면 앱을 설치해주세요.');
            document.querySelector('[style*="z-index: 2500"]').remove();
        }

        // 카카오내비 열기
        function openKakaoNavi(name, lat, lng) {
            const url = `kakaomap://route?ep=${lat},${lng}&by=CAR`;
            window.open(url, '_blank');
            showAlert('카카오내비가 실행되지 않으면 앱을 설치해주세요.');
            document.querySelector('[style*="z-index: 2500"]').remove();
        }

        // 네이버지도 열기
        function openNaverMap(name, lat, lng) {
            const url = `nmap://route/car?dlat=${lat}&dlng=${lng}&dname=${encodeURIComponent(name)}`;
            window.open(url, '_blank');
            showAlert('네이버지도가 실행되지 않으면 앱을 설치해주세요.');
            document.querySelector('[style*="z-index: 2500"]').remove();
        }

        // 팀원 배정
        function assignTeamMember(selectElement, deviceId) {
            const member = selectElement.value;
            if (member) {
                showAlert(`${deviceId} 장비를 ${member}님에게 배정했습니다.`);
            } else {
                showAlert(`${deviceId} 장비 배정을 취소했습니다.`);
            }
        }

        // 튜토리얼 표시
        function showTutorial() {
            document.getElementById('tutorialOverlay').style.display = 'flex';
        }

        // 튜토리얼 닫기
        function closeTutorial() {
            document.getElementById('tutorialOverlay').style.display = 'none';
        }

        // 튜토리얼 다음 단계
        let tutorialStep = 1;
        function nextTutorialStep() {
            tutorialStep++;
            const progressFill = document.querySelector('.progress-fill');
            const tutorialContent = document.querySelector('.tutorial-content');
            
            switch(tutorialStep) {
                case 2:
                    progressFill.style.width = '60%';
                    tutorialContent.innerHTML = `
                        <p><strong>대시보드</strong></p>
                        <p>전체 AED 현황을 한눈에 파악할 수 있습니다.</p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>전체 장비 수</li>
                            <li>점검 필요 장비</li>
                            <li>만료 임박 장비</li>
                            <li>오늘 점검 완료</li>
                        </ul>
                        <p style="margin-top: 15px;">긴급 점검이 필요한 장비는 상단에 표시됩니다.</p>
                    `;
                    break;
                case 3:
                    progressFill.style.width = '100%';
                    tutorialContent.innerHTML = `
                        <p><strong>점검 관리</strong></p>
                        <p>AED 점검을 수행하고 기록을 관리합니다.</p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>QR 코드 스캔으로 빠른 점검</li>
                            <li>사진 촬영 및 첨부</li>
                            <li>점검 항목 체크리스트</li>
                            <li>위치 정보 자동 기록</li>
                        </ul>
                        <p style="margin-top: 15px;">모바일 기기에서도 동일하게 사용 가능합니다!</p>
                    `;
                    document.querySelector('.btn-primary').textContent = '시작하기';
                    break;
                case 4:
                    closeTutorial();
                    tutorialStep = 1;
                    break;
            }
        }

        // 알림 표시 함수
        function showAlert(message) {
            // 임시 알림 표시
            const alert = document.createElement('div');
            alert.style.cssText = `
                position: fixed;
                top: 80px;
                right: 20px;
                background: #10b981;
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                z-index: 3000;
                animation: slideIn 0.3s ease;
            `;
            alert.textContent = message;
            document.body.appendChild(alert);
            
            setTimeout(() => {
                alert.style.animation = 'fadeOut 0.3s ease';
                setTimeout(() => alert.remove(), 300);
            }, 3000);
        }

        // 알림 센터 표시/숨기기
        function showNotifications() {
            const center = document.getElementById('notificationCenter');
            center.style.display = center.style.display === 'block' ? 'none' : 'block';
        }

        function closeNotifications() {
            document.getElementById('notificationCenter').style.display = 'none';
        }

        // 검색 모달
        function showSearch() {
            const searchModal = document.createElement('div');
            searchModal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.9);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 2500;
            `;
            searchModal.innerHTML = `
                <div style="width: 600px; max-width: 90%;">
                    <input type="text" placeholder="전체 시스템 검색..." style="
                        width: 100%;
                        padding: 20px;
                        font-size: 20px;
                        background: #1a1a1a;
                        border: 2px solid #10b981;
                        border-radius: 12px;
                        color: white;
                        outline: none;
                    " autofocus>
                    <div style="margin-top: 20px; color: #888; text-align: center;">
                        ESC를 눌러 닫기
                    </div>
                </div>
            `;
            
            searchModal.addEventListener('click', (e) => {
                if (e.target === searchModal) {
                    searchModal.remove();
                }
            });
            
            searchModal.querySelector('input').addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    searchModal.remove();
                } else if (e.key === 'Enter') {
                    showAlert(`'${e.target.value}' 검색 중...`);
                    searchModal.remove();
                }
            });
            
            document.body.appendChild(searchModal);
        }

        // 애니메이션 스타일 추가
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes fadeOut {
                from { opacity: 1; }
                to { opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // 실시간 데이터 시뮬레이션
        function simulateRealtimeData() {
            setInterval(() => {
                // 랜덤하게 숫자 업데이트
                const statValues = document.querySelectorAll('.stat-value');
                statValues.forEach((value, index) => {
                    if (Math.random() > 0.7) {
                        const current = parseInt(value.textContent);
                        const change = Math.floor(Math.random() * 3) - 1;
                        const newValue = Math.max(0, current + change);
                        if (newValue !== current) {
                            value.style.animation = 'pulse 0.5s ease';
                            value.textContent = newValue;
                            setTimeout(() => value.style.animation = '', 500);
                        }
                    }
                });
            }, 5000);
        }

        // 검색 기능 시뮬레이션
        document.querySelectorAll('.search-input').forEach(input => {
            input.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    showAlert(`'${input.value}' 검색 중...`);
                    setTimeout(() => {
                        showAlert('검색 완료: 3개 결과 발견');
                    }, 1000);
                }
            });
        });

        // 필터 변경 시뮬레이션
        document.querySelectorAll('select').forEach(select => {
            select.addEventListener('change', () => {
                showAlert(`필터 적용: ${select.value}`);
            });
        });

        // 테이블 행 클릭 상호작용
        document.querySelectorAll('tbody tr').forEach(row => {
            row.style.cursor = 'pointer';
            row.addEventListener('click', (e) => {
                if (!e.target.matches('button')) {
                    row.style.background = row.style.background ? '' : 'rgba(74,144,226,0.1)';
                }
            });
        });

        // 키보드 단축키
        document.addEventListener('keydown', (e) => {
            // Ctrl/Cmd + K: 빠른 검색
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                const searchInput = document.querySelector('.search-input');
                if (searchInput) {
                    searchInput.focus();
                    searchInput.select();
                }
            }
            // ESC: 튜토리얼 닫기
            if (e.key === 'Escape') {
                closeTutorial();
            }
            // ?: 도움말 표시
            if (e.key === '?' && !e.target.matches('input, textarea')) {
                e.preventDefault();
                showTutorial();
            }
        });

        // 차트 시뮬레이션 (간단한 막대 차트)
        function createMiniChart(container) {
            const data = [65, 59, 80, 81, 56, 55, 70];
            const maxValue = Math.max(...data);
            const chartHTML = `
                <div style="display: flex; align-items: flex-end; height: 100px; gap: 5px; padding: 10px;">
                    ${data.map(value => `
                        <div style="
                            flex: 1;
                            background: linear-gradient(to top, #10b981, #357abd);
                            height: ${(value/maxValue)*100}%;
                            border-radius: 2px 2px 0 0;
                            transition: all 0.3s ease;
                            cursor: pointer;
                        " onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'" 
                           onclick="showAlert('값: ${value}')"></div>
                    `).join('')}
                </div>
            `;
            container.innerHTML = chartHTML;
        }

        // 초기 로드시 설정
        window.addEventListener('load', () => {
            // 실시간 데이터 시뮬레이션 시작
            simulateRealtimeData();
            
            // 첫 방문시 자동으로 튜토리얼 표시
            if (!localStorage.getItem('tutorialShown')) {
                setTimeout(() => {
                    showTutorial();
                    localStorage.setItem('tutorialShown', 'true');
                }, 1000);
            }
        });

        // 모바일 메뉴 토글
        function toggleMobileMenu() {
            document.getElementById('sidebar').classList.toggle('open');
        }

        // 드래그 앤 드롭 시뮬레이션
        let draggedElement = null;
        
        document.querySelectorAll('.stat-card').forEach(card => {
            card.draggable = true;
            card.style.cursor = 'move';
            
            card.addEventListener('dragstart', (e) => {
                draggedElement = e.target;
                e.target.style.opacity = '0.5';
            });
            
            card.addEventListener('dragend', (e) => {
                e.target.style.opacity = '';
            });
            
            card.addEventListener('dragover', (e) => {
                e.preventDefault();
                e.target.style.border = '2px dashed #10b981';
            });
            
            card.addEventListener('dragleave', (e) => {
                e.target.style.border = '';
            });
            
            card.addEventListener('drop', (e) => {
                e.preventDefault();
                e.target.style.border = '';
                if (draggedElement !== e.target && e.target.classList.contains('stat-card')) {
                    const parent = e.target.parentNode;
                    const draggedIndex = Array.from(parent.children).indexOf(draggedElement);
                    const targetIndex = Array.from(parent.children).indexOf(e.target);
                    
                    if (draggedIndex < targetIndex) {
                        parent.insertBefore(draggedElement, e.target.nextSibling);
                    } else {
                        parent.insertBefore(draggedElement, e.target);
                    }
                    showAlert('위젯 순서가 변경되었습니다');
                }
            });
        })

        // 권한별 대시보드 필터링
        function changeUserRole() {
            const role = document.getElementById('userRole').value;
            const filterDiv = document.getElementById('dashboardFilter');
            const totalAED = document.getElementById('totalAED');
            
            if (role === 'local') {
                // 보건소 담당자는 필터 없음
                filterDiv.style.display = 'none';
                totalAED.textContent = '327';
            } else if (role === 'regional') {
                // 시도 담당자는 구/군 선택 가능
                filterDiv.style.display = 'block';
                document.getElementById('districtFilter').style.display = 'inline-block';
                updateDistrictOptions('seoul');
                totalAED.textContent = '5,238';
            } else {
                // 복지부, 중앙응급의료센터는 시도 선택 가능
                filterDiv.style.display = 'block';
                document.getElementById('districtFilter').style.display = 'none';
                totalAED.textContent = '80,000';
            }
        }

        function updateDistrictOptions(region) {
            const districtFilter = document.getElementById('districtFilter');
            districtFilter.innerHTML = '<option value="all">전체 구/군</option>';
            
            const districts = {
                'seoul': ['종로구', '중구', '용산구', '성동구', '광진구', '동대문구', '중랑구', '성북구', '강북구', '도봉구', '노원구', '은평구', '서대문구', '마포구', '양천구', '강서구', '구로구', '금천구', '영등포구', '동작구', '관악구', '서초구', '강남구', '송파구', '강동구'],
                'busan': ['중구', '서구', '동구', '영도구', '부산진구', '동래구', '남구', '북구', '해운대구', '사하구', '금정구', '강서구', '연제구', '수영구', '사상구', '기장군']
            };
            
            if (districts[region]) {
                districts[region].forEach(district => {
                    const option = document.createElement('option');
                    option.value = district;
                    option.textContent = district;
                    districtFilter.appendChild(option);
                });
            }
        }

        function updateDashboard() {
            const region = document.getElementById('regionFilter').value;
            const district = document.getElementById('districtFilter').value;
            
            // 지역 변경시 구/군 옵션 업데이트
            if (region !== 'all') {
                updateDistrictOptions(region);
            }
            
            showAlert('대시보드가 업데이트되었습니다');
        }

        // 팀원 추가 모달
        function showAddMemberModal() {
            const modal = document.createElement('div');
            modal.className = 'modal-overlay';
            modal.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); display: flex; align-items: center; justify-content: center; z-index: 10000;';
            
            modal.innerHTML = `
                <div class="modal-content" style="background: #1a1a1a; padding: 30px; border-radius: 12px; width: 400px; border: 1px solid #333;">
                    <h2 style="margin-bottom: 20px; color: #fff;">팀원 추가</h2>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; color: #888;">이름</label>
                        <input type="text" id="newMemberName" style="width: 100%; padding: 8px; background: #222; border: 1px solid #666; border-radius: 4px; color: #fff;">
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; color: #888;">소속</label>
                        <input type="text" id="newMemberDept" style="width: 100%; padding: 8px; background: #222; border: 1px solid #666; border-radius: 4px; color: #fff;">
                    </div>
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 5px; color: #888;">할당량</label>
                        <input type="number" id="newMemberQuota" value="10" style="width: 100%; padding: 8px; background: #222; border: 1px solid #666; border-radius: 4px; color: #fff;">
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="addNewMember()">추가</button>
                        <button class="btn btn-secondary" onclick="this.closest('.modal-overlay').remove()">취소</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        function addNewMember() {
            const name = document.getElementById('newMemberName').value;
            const dept = document.getElementById('newMemberDept').value;
            const quota = document.getElementById('newMemberQuota').value;
            
            if (!name || !dept) {
                showAlert('이름과 소속을 입력해주세요');
                return;
            }
            
            const tbody = document.getElementById('teamMembersList');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td>${name}</td>
                <td>${dept}</td>
                <td>${quota}</td>
                <td>0</td>
                <td><div style="background: #333; border-radius: 4px; overflow: hidden; height: 20px;"><div style="background: #10b981; height: 100%; width: 0%;"></div></div></td>
                <td><button class="btn btn-secondary" onclick="showMemberDetails('${name}', ${quota}, 0)">상세보기</button></td>
            `;
            tbody.appendChild(newRow);
            
            document.querySelector('.modal-overlay').remove();
            showAlert(`${name}님이 추가되었습니다`);
        }

        // 검색 모드 전환
        function showSearchMode(mode) {
            // 모든 버튼 초기화
            document.querySelectorAll('[id^="search"]').forEach(btn => {
                btn.className = 'btn btn-secondary';
            });
            
            const searchArea = document.getElementById('searchInputArea');
            const searchInput = document.getElementById('searchInput');
            
            if (mode === 'priority') {
                document.getElementById('searchPriority').className = 'btn btn-primary';
                searchArea.style.display = 'none';
                updateInspectionList('priority');
            } else if (mode === 'name') {
                document.getElementById('searchName').className = 'btn btn-primary';
                searchArea.style.display = 'block';
                searchInput.placeholder = '설치기관명을 입력하세요...';
            } else if (mode === 'serial') {
                document.getElementById('searchSerial').className = 'btn btn-primary';
                searchArea.style.display = 'block';
                searchInput.placeholder = '장비연번을 입력하세요 (예: 13-0000001)';
            } else if (mode === 'gps') {
                document.getElementById('searchGPS').className = 'btn btn-primary';
                searchArea.style.display = 'none';
                requestGPSLocation();
            }
        }

        // GPS 위치 요청
        function requestGPSLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        showAlert('현재 위치에서 가까운 AED를 검색합니다');
                        updateInspectionList('gps', position.coords);
                    },
                    (error) => {
                        showAlert('위치 권한이 필요합니다');
                    }
                );
            } else {
                showAlert('GPS를 지원하지 않는 브라우저입니다');
            }
        }

        // 점검 리스트 업데이트
        function updateInspectionList(mode, params) {
            const list = document.getElementById('inspectionList');
            const hasSchedule = document.querySelector('input[type="checkbox"]:checked');
            
            // 스케줄 모드 토글시 상태 표시 변경
            const scheduleStatus = document.getElementById('scheduleStatus');
            if (!hasSchedule || mode === 'recommended') {
                scheduleStatus.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 24px;">💡</span>
                        <div>
                            <h3 style="margin: 0; color: #f39c12;">추천 점검 대상 (우선순위 기반)</h3>
                            <p style="margin: 5px 0 0 0; color: #888; font-size: 14px;">스케줄 미설정 - 자동 추천 리스트</p>
                        </div>
                    </div>
                `;
                scheduleStatus.style.background = '#4a3a1a';
                scheduleStatus.style.borderColor = '#5a4a2a';
            } else {
                scheduleStatus.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 24px;">📅</span>
                        <div>
                            <h3 style="margin: 0; color: #10b981;">오늘의 점검 스케줄 (12건)</h3>
                            <p style="margin: 5px 0 0 0; color: #888; font-size: 14px;">설정된 스케줄에 따른 점검 대상</p>
                        </div>
                    </div>
                `;
                scheduleStatus.style.background = '#1a3a52';
                scheduleStatus.style.borderColor = '#2a4a62';
            }
        }

        // 스케줄 모드 토글
        function toggleScheduleMode() {
            const checkbox = event.target;
            if (checkbox.checked) {
                // 추천 모드로 전환
                updateInspectionList('recommended');
                const list = document.getElementById('inspectionList');
                list.innerHTML = `
                    <div style="background: #2a2a1a; padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 1px solid #4a4a2a;">
                        <p style="color: #f39c12; margin: 0;">⚠️ 스케줄이 설정되지 않아 우선순위에 따라 자동 추천됩니다</p>
                    </div>
                    
                    <!-- 추천 항목 1 -->
                    <div class="inspection-card" style="background: #1a1a1a; padding: 20px; border-radius: 8px; border-left: 4px solid #e74c3c;">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                            <div>
                                <span style="background: #e74c3c; color: white; padding: 2px 8px; border-radius: 4px; font-size: 12px;">우선 1</span>
                                <h3 style="margin: 10px 0 5px 0; color: #fff;">서울시청 본관</h3>
                                <p style="color: #888; font-size: 14px;">장비연번: 13-0000042</p>
                            </div>
                            <div style="text-align: right;">
                                <span class="badge badge-danger">배터리 D-5</span>
                            </div>
                        </div>
                        <div style="color: #666; font-size: 14px; margin-bottom: 15px;">
                            추천 사유: 배터리 만료 임박
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-primary" onclick="startInspection('13-0000042')" style="flex: 1;">점검 시작</button>
                            <button class="btn btn-secondary" onclick="startNavigation('서울시청', '37.5662952', '126.9779451')">길안내</button>
                        </div>
                    </div>
                    
                    <!-- 추천 항목 2 -->
                    <div class="inspection-card" style="background: #1a1a1a; padding: 20px; border-radius: 8px; border-left: 4px solid #f39c12;">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                            <div>
                                <span style="background: #f39c12; color: white; padding: 2px 8px; border-radius: 4px; font-size: 12px;">우선 2</span>
                                <h3 style="margin: 10px 0 5px 0; color: #fff;">강남구청</h3>
                                <p style="color: #888; font-size: 14px;">장비연번: 13-0000156</p>
                            </div>
                            <div style="text-align: right;">
                                <span class="badge badge-warning">패드 D-25</span>
                            </div>
                        </div>
                        <div style="color: #666; font-size: 14px; margin-bottom: 15px;">
                            추천 사유: 패드 교체 예정
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-primary" onclick="startInspection('13-0000156')" style="flex: 1;">점검 시작</button>
                            <button class="btn btn-secondary" onclick="startNavigation('강남구청', '37.5172363', '127.0473248')">길안내</button>
                        </div>
                    </div>
                `;
            } else {
                // 스케줄 모드로 복귀
                location.reload();
            }
        }

        // 검색 수행
        function performSearch() {
            const searchValue = document.getElementById('searchInput').value;
            if (!searchValue) {
                showAlert('검색어를 입력해주세요');
                return;
            }
            showAlert(`'${searchValue}' 검색 결과를 표시합니다`);
            // 실제로는 검색 결과를 필터링하여 표시
        }

        // 운영시간 확인
        function confirmOperatingHours() {
            const confirmBtn = document.getElementById('hoursConfirm');
            confirmBtn.textContent = '확인됨';
            confirmBtn.className = 'btn btn-success';
            confirmBtn.disabled = true;
            document.getElementById('hoursEdit').style.display = 'none';
        }

        // 운영시간 수정 모드
        function showHoursEdit() {
            document.getElementById('hoursEditArea').style.display = 'flex';
            document.getElementById('hoursConfirm').style.display = 'none';
            document.getElementById('hoursEdit').style.display = 'none';
        }

        // 커스텀 시간 토글
        function toggleCustomHours() {
            const hoursType = document.getElementById('hoursType').value;
            const customArea = document.getElementById('customHoursArea');
            customArea.style.display = hoursType === 'custom' ? 'block' : 'none';
        }

        // 운영시간 저장
        function saveHours() {
            const hoursType = document.getElementById('hoursType').value;
            let hoursText = '';
            
            if (hoursType === '24h') {
                hoursText = '24시간';
            } else if (hoursType === 'office') {
                hoursText = '09:00-18:00';
            } else {
                const openTime = document.getElementById('openTime').value;
                const closeTime = document.getElementById('closeTime').value;
                if (!openTime || !closeTime) {
                    showAlert('운영시간을 입력해주세요');
                    return;
                }
                hoursText = `${openTime}-${closeTime}`;
            }
            
            document.getElementById('hoursEditArea').style.display = 'none';
            const confirmBtn = document.getElementById('hoursConfirm');
            confirmBtn.textContent = '수정됨';
            confirmBtn.className = 'btn btn-warning';
            confirmBtn.style.display = 'inline-block';
            confirmBtn.disabled = true;
            
            showAlert(`운영시간이 ${hoursText}로 수정되었습니다`);
        }

        // 위치 확인
        function confirmLocation() {
            const confirmBtn = document.getElementById('locationConfirm');
            confirmBtn.textContent = '확인됨';
            confirmBtn.className = 'btn btn-success';
            confirmBtn.disabled = true;
            document.getElementById('locationEdit').style.display = 'none';
        }

        // 카카오 지도 관련 변수
        let kakaoMap = null;
        let kakaoMarker = null;
        let isEditingLocation = false;
        let currentLat = 37.5662952;
        let currentLng = 126.9779451;
        let hasLocationChanged = false;
        
        // 카카오맵 초기화
        function initKakaoMap() {
            // 카카오맵 API가 로드될 때까지 대기
            if (typeof kakao === 'undefined') {
                console.log('카카오맵 API 로딩 중...');
                setTimeout(initKakaoMap, 500);
                return;
            }
            
            // 카카오맵 로드
            kakao.maps.load(() => {
                console.log('카카오맵 로드 완료');
                createMap();
            });
        }
        
        // 지도 생성
        function createMap() {
            try {
                const container = document.getElementById('kakaoMapContainer');
                if (!container) {
                    console.error('지도 컨테이너를 찾을 수 없습니다');
                    return;
                }
                
                console.log('지도 컨테이너 찾음:', container);
                
                // 컨테이너에 높이가 없으면 설정
                if (!container.style.height || container.offsetHeight === 0) {
                    container.style.height = '400px';
                }
                
                const options = {
                    center: new kakao.maps.LatLng(currentLat, currentLng),
                    level: 3
                };
                
                console.log('지도 생성 시작...');
                kakaoMap = new kakao.maps.Map(container, options);
                console.log('지도 생성 완료');
                
                // 로딩 메시지 숨기기
                const loadingMsg = document.getElementById('mapLoading');
                if (loadingMsg) {
                    loadingMsg.style.display = 'none';
                }
                
                // 줌 컨트롤 추가
                const zoomControl = new kakao.maps.ZoomControl();
                kakaoMap.addControl(zoomControl, kakao.maps.ControlPosition.RIGHT);
                
                // 마커 추가
                kakaoMarker = new kakao.maps.Marker({
                    position: new kakao.maps.LatLng(currentLat, currentLng),
                    map: kakaoMap,
                    draggable: false
                });
                
                console.log('마커 추가 완료');
                
                // 지도 리사이즈 (지도가 숨겨진 상태에서 생성된 경우를 위해)
                setTimeout(() => {
                    kakaoMap.relayout();
                }, 200);
                
            } catch (error) {
                console.error('카카오맵 생성 오류:', error);
            }
        }
        
        // 위치 업데이트
        function updateLocation(lat, lng) {
            currentLat = lat;
            currentLng = lng;
            document.getElementById('latDisplay').textContent = lat.toFixed(7);
            document.getElementById('lngDisplay').textContent = lng.toFixed(7);
            hasLocationChanged = true;
        }
        
        // 위치 수정 모드 활성화
        function enableLocationEdit() {
            isEditingLocation = true;
            hasLocationChanged = false;
            
            // UI 업데이트
            document.getElementById('mapEditHint').style.display = 'block';
            document.getElementById('locationConfirm').style.display = 'none';
            document.getElementById('locationEdit').style.display = 'none';
            document.getElementById('locationGPS').style.display = 'inline-block';
            document.getElementById('locationSave').style.display = 'inline-block';
            
            // 카카오맵 마커 드래그 가능하게 설정
            if (kakaoMarker) {
                kakaoMarker.setDraggable(true);
                
                // 드래그 종료 이벤트
                kakao.maps.event.addListener(kakaoMarker, 'dragend', function() {
                    const position = kakaoMarker.getPosition();
                    updateLocation(position.getLat(), position.getLng());
                    if (hasLocationChanged) {
                        showLocationChangeConfirmation();
                    }
                });
            }
            
            // 지도 클릭 이벤트
            if (kakaoMap) {
                kakao.maps.event.addListener(kakaoMap, 'click', function(mouseEvent) {
                    const latlng = mouseEvent.latLng;
                    kakaoMarker.setPosition(latlng);
                    updateLocation(latlng.getLat(), latlng.getLng());
                    showLocationChangeConfirmation();
                });
            }
        }
        
        
        // 위치 변경 확인 다이얼로그
        function showLocationChangeConfirmation() {
            // 기존 다이얼로그 제거
            const existingDialog = document.getElementById('locationChangeDialog');
            if (existingDialog) existingDialog.remove();
            
            const dialog = document.createElement('div');
            dialog.id = 'locationChangeDialog';
            dialog.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: #2a2a2a;
                border: 2px solid #10b981;
                border-radius: 10px;
                padding: 20px;
                z-index: 10000;
                box-shadow: 0 4px 20px rgba(0,0,0,0.5);
                min-width: 300px;
                text-align: center;
            `;
            
            dialog.innerHTML = `
                <div style="color: #fff; margin-bottom: 20px; font-size: 16px;">
                    수정된 위치로 변경하시겠습니까?
                </div>
                <div style="display: flex; gap: 10px; justify-content: center;">
                    <button onclick="confirmLocationChange()" style="
                        background: #10b981;
                        color: white;
                        border: none;
                        padding: 10px 20px;
                        border-radius: 5px;
                        cursor: pointer;
                        font-size: 14px;
                    ">변경</button>
                    <button onclick="cancelLocationChange()" style="
                        background: #666;
                        color: white;
                        border: none;
                        padding: 10px 20px;
                        border-radius: 5px;
                        cursor: pointer;
                        font-size: 14px;
                    ">취소</button>
                </div>
            `;
            
            document.body.appendChild(dialog);
        }
        
        // 위치 변경 확인
        function confirmLocationChange() {
            hasLocationChanged = false;
            
            const dialog = document.getElementById('locationChangeDialog');
            if (dialog) dialog.remove();
        }
        
        // 위치 변경 취소
        function cancelLocationChange() {
            // 원래 위치로 복원
            if (kakaoMarker && kakaoMap) {
                const originalPosition = new kakao.maps.LatLng(37.5662952, 126.9779451);
                kakaoMarker.setPosition(originalPosition);
                kakaoMap.setCenter(originalPosition);
                
                currentLat = 37.5662952;
                currentLng = 126.9779451;
                document.getElementById('latDisplay').textContent = currentLat.toFixed(7);
                document.getElementById('lngDisplay').textContent = currentLng.toFixed(7);
            }
            
            hasLocationChanged = false;
            
            const dialog = document.getElementById('locationChangeDialog');
            if (dialog) dialog.remove();
        }

        // 현재 위치 가져오기
        function getCurrentLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const lat = position.coords.latitude;
                        const lng = position.coords.longitude;
                        const newPosition = new kakao.maps.LatLng(lat, lng);
                        
                        if (kakaoMap && kakaoMarker) {
                            kakaoMap.setCenter(newPosition);
                            kakaoMarker.setPosition(newPosition);
                        }
                        
                        updateLocation(lat, lng);
                        showAlert('현재 위치로 설정되었습니다');
                    },
                    (error) => {
                        showAlert('위치 권한이 필요합니다');
                    }
                );
            } else {
                showAlert('GPS를 지원하지 않는 브라우저입니다');
            }
        }

        // 위치 저장
        function saveLocation() {
            // 변경사항이 있으면 최종 확인
            if (hasLocationChanged) {
                confirmLocationChange();
            }
            
            isEditingLocation = false;
            
            // 카카오맵 마커 드래그 비활성화
            if (kakaoMarker) {
                kakaoMarker.setDraggable(false);
            }
            
            // 이벤트 제거
            if (kakaoMap) {
                kakao.maps.event.removeListener(kakaoMap, 'click');
            }
            
            // UI 복원
            document.getElementById('mapEditHint').style.display = 'none';
            document.getElementById('locationGPS').style.display = 'none';
            document.getElementById('locationSave').style.display = 'none';
            
            const confirmBtn = document.getElementById('locationConfirm');
            confirmBtn.textContent = '수정됨';
            confirmBtn.className = 'btn btn-warning';
            confirmBtn.style.display = 'inline-block';
            confirmBtn.disabled = true;
            
            showAlert(`위치가 위도 ${currentLat.toFixed(7)}, 경도 ${currentLng.toFixed(7)}로 수정되었습니다`);
        }

        // 점검 시작
        function startInspection(serialNumber) {
            showAlert(`장비 ${serialNumber} 점검을 시작합니다`);
            document.getElementById('inspectionModal').style.display = 'flex';
            
            // 카카오맵 초기화 (약간의 지연 후)
            setTimeout(() => {
                if (!kakaoMap) {
                    initKakaoMap();
                } else {
                    // 맵이 이미 있으면 리사이즈
                    kakaoMap.relayout();
                }
            }, 100);
        }

        // 팀원 상세보기 모달
        function showMemberDetails(name, total, completed) {
            const modal = document.createElement('div');
            modal.className = 'modal-overlay';
            modal.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); display: flex; align-items: center; justify-content: center; z-index: 10000;';
            
            const remaining = total - completed;
            const completedList = [];
            const remainingList = [];
            
            // 샘플 데이터 생성
            for (let i = 1; i <= completed; i++) {
                completedList.push(`서울시청 ${i}관 - AED #13-000${1000 + i}`);
            }
            for (let i = 1; i <= remaining; i++) {
                remainingList.push(`강남구청 ${i}동 - AED #13-000${2000 + i}`);
            }
            
            modal.innerHTML = `
                <div class="modal-content" style="background: #1a1a1a; padding: 30px; border-radius: 12px; width: 600px; max-height: 80vh; overflow-y: auto; border: 1px solid #333;">
                    <h2 style="margin-bottom: 20px; color: #fff;">${name} - 점검 상세정보</h2>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div style="background: #222; padding: 15px; border-radius: 8px;">
                            <h3 style="color: #10b981; margin-bottom: 10px;">완료된 점검 (${completed}건)</h3>
                            <ul style="list-style: none; padding: 0; max-height: 200px; overflow-y: auto;">
                                ${completedList.map(item => `<li style="padding: 5px 0; color: #888;">✓ ${item}</li>`).join('')}
                            </ul>
                        </div>
                        
                        <div style="background: #222; padding: 15px; border-radius: 8px;">
                            <h3 style="color: #f39c12; margin-bottom: 10px;">대기 중인 점검 (${remaining}건)</h3>
                            <ul style="list-style: none; padding: 0; max-height: 200px; overflow-y: auto;">
                                ${remainingList.map(item => `<li style="padding: 5px 0; color: #888;">○ ${item}</li>`).join('')}
                            </ul>
                        </div>
                    </div>
                    
                    <div style="background: #222; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <h3 style="color: #fff; margin-bottom: 10px;">진행 상황</h3>
                        <div style="background: #333; border-radius: 4px; overflow: hidden; height: 30px; margin-bottom: 10px;">
                            <div style="background: linear-gradient(90deg, #10b981, #5aa3f0); height: 100%; width: ${(completed/total*100).toFixed(0)}%; transition: width 0.3s;"></div>
                        </div>
                        <p style="color: #888; text-align: center;">${completed} / ${total} 완료 (${(completed/total*100).toFixed(0)}%)</p>
                    </div>
                    
                    <div style="text-align: right;">
                        <button class="btn btn-secondary" onclick="this.closest('.modal-overlay').remove()">닫기</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }
    </script>
</body>
</html>