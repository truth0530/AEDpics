# 임시점검원 관리 표준 운영 절차

## 개요

임시점검원(Temporary Inspector)은 일반 이메일 도메인(@korea.kr, @nmc.or.kr 제외)으로 가입한 사용자로, **반드시 local_admin(보건소 담당자)이 있는 조직에만 소속**될 수 있습니다.

## 1. 가입 프로세스 (신규)

### 1.1 회원가입 단계에서의 제한

```
[클라이언트 검증]
임시점검원 회원가입 시 → 담당자 있는 조직만 목록 표시

[서버 검증]
가입 API에서 → 선택 조직의 local_admin 존재 여부 재확인
                → 담당자 없으면 가입 거부 + 관리자 알림
```

### 1.2 가입 거부 시나리오

#### Case A: 담당자 없는 조직 선택 시도
```
상황: 임시점검원이 담당자 없는 조직에 가입 시도
발생: 회원가입 API에서 검증 실패
처리:
  1. 사용자에게 명확한 오류 메시지 표시
  2. 관리자에게 자동 알림 발송
     - 관리자명, 연락처
     - 가입 임시점검원 정보
     - 선택 조직과 상태
```

#### Case B: 임시점검원이 선택 가능한 조직이 없는 지역
```
상황: 지역 내 모든 보건소에 담당자 없음
발생: 회원가입 화면에서 선택 가능한 조직 없음
처리:
  1. UI에서 명확한 안내 메시지 표시
  2. 관할 응급의료지원센터 연락처 제공
  3. 담당자 생성 요청 유도
```

## 2. 기존 임시점검원 관리

### 2.1 "고아(Orphan) 임시점검원" 정의

```
정의: 소속 조직에 local_admin이 없는 임시점검원

상태:
  - 장비는 할당됨
  - 점검 활동은 불가능 (대리 승인자 없음)
  - 관리상 문제 발생 위험
```

### 2.2 현황 모니터링

**현재 상태 (2025-11-08 기준)**:

| 지역 | 임시점검원 | 현황 | 우선순위 |
|------|-----------|------|--------|
| 충청북도 | 김시하 (aeri6@naver.com) | 충주시 보건소에 30개 장비 할당 | 🔴 높음 |
| 충청남도 | 유미경 (db931210@gmail.com) | 계룡시 보건소에 30개 장비 할당 | 🔴 높음 |
| 경상북도 | 안은규 (mentalchange@naver.com) | 경산시 보건소에 30개 장비 할당 | 🔴 높음 |
| 부산광역시 | 김강수 (fall0788@naver.com) | 북구 보건소에 30개 장비 할당 | 🔴 높음 |

### 2.3 해결 방안 (우선순위 순)

#### 1순위: 담당자(local_admin) 생성
```
방법: 해당 지역의 시청/도청 또는 시군구청 담당자를 local_admin으로 등록
효과:
  - 임시점검원이 즉시 활동 가능
  - 별도 재할당 불필요
  - 장비 할당도 유지

실행:
  1. 관할 응급의료지원센터에 담당자 확인 요청
  2. 담당자 이메일(@korea.kr) 확보
  3. 관리자가 해당 조직에 local_admin 계정 생성
  4. 활성화 후 임시점검원 즉시 활동 가능
```

#### 2순위: 다른 지역의 담당자 있는 조직으로 재할당
```
조건: 임시점검원이 이동 가능한 지역이 있을 경우에만

현황: 담당자 있는 조직 (9곳)
  - 대구광역시: 5곳
  - 경남(김해시): 1곳
  - 인천광역시: 1곳
  - 제주도: 2곳

주의사항:
  - 실제 점검 업무와 지역 간극 발생
  - 최후의 수단으로 고려
  - 임시점검원 동의 필수

실행 절차:
  1. 임시점검원과 협의
  2. /admin/users/edit/[id] 페이지에서 조직 변경
  3. team_members 자동 동기화
  4. 기존 할당 장비는 새 조직으로 재할당
```

#### 3순위: 임시 대리 승인자 지정 (system admin)
```
조건: 1, 2순위가 불가능한 경우
제한사항:
  - 임시방편
  - 정식 담당자 생성까지의 과도기 조치
  - 반드시 문서화 필요

실행:
  1. 시스템 관리자(master) ID 확인
  2. 장비 할당 API에서 assigned_by를 시스템 관리자로 설정
  3. 임시점검원이 활동 중인 장비 조회
  4. 승인 권한을 시스템 관리자가 대행

보고서:
  - 주간 모니터링 통계에 "대리 승인" 항목 추가
  - 정식 담당자 생성 계획 수립
```

## 3. 모니터링 대시보드

### 3.1 관리자 대시보드 위치
- **URL**: `/admin/users` 하단에 "조직 관리 현황" 섹션 추가

### 3.2 주요 지표 (KPI)

```
1. 담당자 커버리지
   - 담당자 있는 조직: 9 / 265 (3.4%)
   - 담당자 필요 조직: 256곳
   - 우선순위: 임시점검원 소속 4곳 (충주, 계룡, 경산, 부산북구)

2. 임시점검원 상태
   - 정상 (담당자 있음): 4명
   - 고아 상태 (담당자 없음): 4명
   - 미할당: 0명

3. 미해결 이슈
   - 새 가입 거부된 임시점검원
   - 담당자 미확보 지역
```

### 3.3 주간 모니터링 리포트

**주기**: 매주 월요일 오전 10시
**대상**: 마스터 관리자, 시도 regional_admin
**내용**:

```
주간 임시점검원 관리 현황

[이번주 신규 가입]
- 거부된 건: X건
  * 원인: 담당자 없는 조직 선택
  * 지역별 분포

[고아 임시점검원 현황]
- 여전히 미해결: 4명
- 진행 중인 담당자 생성: X명
- 재할당 완료: X명

[다음주 액션 아이템]
- [ ] 담당자 생성 요청
- [ ] 임시점검원 재할당
- [ ] 지역별 담당자 확인
```

## 4. 권역별 담당자 정보 (2025-11-08)

### 대구광역시 (5곳) ✅ 완전 커버
```
- 중구 보건소: 이광성중구보건소 (nemcdg@korea.kr), 김도희 (khee33@korea.kr)
- 서구 보건소: 김근하 (khhh510@korea.kr)
- 수성구 보건소: 손지안 (jian91@korea.kr)
- 북구 보건소: 최진희 (hellojh56@korea.kr)
- 달서구 보건소: 서가현 (kahyun1220@korea.kr)
```

### 경남 (1곳) ⚠️ 부분 커버
```
- 김해시 보건소: 반서윤(임시) (woals0201@korea.kr)
```

### 인천광역시 (1곳) ⚠️ 부분 커버
```
- 남동구 보건소: 이인학 (hak1212@korea.kr)
```

### 제주도 (2곳) ✅ 완전 커버
```
- 제주시 보건소: 오봉철 (bongbong6878@korea.kr)
- 서귀포시 보건소: 고현아 (kha115@korea.kr)
```

### 미커버 지역 (256곳) 🔴 액션 필요
```
특히 우선:
- 충청북도 (충주시) - 김시하 소속
- 충청남도 (계룡시) - 유미경 소속
- 경상북도 (경산시) - 안은규 소속
- 부산광역시 (북구) - 김강수 소속
```

## 5. 알림 및 에스컬레이션

### 5.1 자동 알림 규칙

```
[가입 거부 시]
- 관리자에게 이메일 발송 (즉시)
- 지역별 regional_admin 동시 알림
- 마스터 관리자 개요 수신

[정기 리마인더]
- 매주 월요일: 임시점검원 현황 리포트
- 매월 1일: 담당자 커버리지 목표 점검
- 분기별: 지역별 담당자 확보 계획 검토
```

### 5.2 에스컬레이션 절차

```
Level 1: 자동 알림 (가입 거부, 주간 리포트)
  → 3일 이내 no response

Level 2: 마스터 관리자 직접 연락
  → 1주일 이내 no response

Level 3: 시도/권역별 응급의료지원센터 직접 연락
  → 정식 담당자 생성 요청

Level 4: 교육부/보건복지부 상급 기관 보고
  → 시스템 차원의 문제로 에스컬레이션
```

## 6. FAQ

### Q1: 임시점검원이 장비는 할당받았는데 승인할 수 없다고 나옵니다.

```
A: 소속 조직에 local_admin(담당자)이 없기 때문입니다.

해결:
1. 관할 응급의료지원센터에 연락
2. 해당 조직의 담당자 이메일(@korea.kr) 확보
3. 관리자가 /admin/users 페이지에서 해당 조직에
   new local_admin 계정 생성
4. 활성화 후 임시점검원이 즉시 점검 진행 가능
```

### Q2: 임시점검원을 다른 조직으로 옮길 수 있나요?

```
A: 가능합니다. /admin/users/edit/[id] 페이지에서:

1. 지역 변경 (선택사항)
2. 조직 변경 (필수 - 담당자 있는 조직만 표시)
3. 저장

주의:
- 지역을 변경하면 조직 목록도 변경됨
- 담당자 없는 조직은 선택 불가
- 기존 할당 장비는 새 조직으로 자동 이전
```

### Q3: 담당자 없는 조직에 이미 소속된 임시점검원은 어떻게 되나요?

```
A: 현재 4명이 이 상태입니다.

우선 처리 방안:
1. 해당 조직의 담당자 생성 (최우선)
   - 가장 현실적이고 효율적
   - 재할당이나 대리 승인보다 깔끔

2. 다른 담당자 있는 조직으로 재할당
   - 지역 간 거리가 멀 수 있음
   - 임시점검원 동의 필요

3. 시스템 관리자 대리 승인
   - 임시방편
   - 정식 담당자 확보까지만
```

### Q4: 언제까지 기다려야 하나요?

```
A: 타임라인:

즉시 (1주):
- 관할 응급의료지원센터 담당자 확인

단기 (2-4주):
- 담당자 계정 생성
- 활성화 및 테스트

중기 (1-3개월):
- 전국 권역별 담당자 확보
- 256개 조직 중 우선순위 50곳 완료 목표

장기 (6개월):
- 전국 모든 보건소에 담당자 배치
```

## 7. 변경 이력

```
2025-11-08: 초판 작성
  - 현황 분석 (담당자 9곳 / 265곳)
  - 임시점검원 4명 고아 상태 확인
  - 표준 운영 절차 수립
```