# 점검 이력 조회 모드 토글 사용 가이드

## 개요

보건소 사용자(local_admin)는 점검 이력을 조회할 때 두 가지 조회 기준을 선택할 수 있습니다:

1. **주소 기준 (Address Mode)** - 물리적 위치로 조회
2. **관할보건소 기준 (Jurisdiction Mode)** - 관리 권한으로 조회

이 두 기준은 다른 결과를 반환할 수 있으며, 각각의 용도가 다릅니다.

---

## 두 모드의 차이점

### 주소 기준 (물리적 위치)

**선택: "주소" / "Address"**

- AED가 **실제로 설치된 위치**의 시도/시군구를 기준으로 조회
- 당신의 보건소 지역에 **물리적으로 위치한** 모든 AED
- 타 지역의 보건소가 관리하는 AED는 조회되지 않음

**사용 시나리오:**
- 당신의 지역에 설치된 모든 장비를 점검하고 싶을 때
- 지역 내 위치 기반 점검 계획을 수립할 때
- 물리적 거리 기반의 순회 점검을 할 때

**예시:**
```
당신: 대구광역시 중구 보건소
조회 결과:
  ✓ 대구광역시 중구에 설치된 AED
  ✗ 다른 지역의 AED (당신이 관리하더라도 제외)
  ✗ 다른 시도의 AED
```

---

### 관할보건소 기준 (관리 권한)

**선택: "관할보건소" / "Jurisdiction"**

- 당신의 보건소가 **관리 권한을 가진** 모든 AED
- 물리적 위치가 어디든 상관없음
- 다른 지역에 설치되었지만 당신이 관리하는 AED도 포함

**사용 시나리오:**
- 당신이 관리 책임을 가진 모든 장비를 점검하고 싶을 때
- 관리 권한별 점검 현황을 파악할 때
- 전국 출장 중 당신의 모든 장비를 확인할 때

**예시:**
```
당신: 대구광역시 중구 보건소
조회 결과:
  ✓ 대구광역시 중구에 설치된 AED (당신이 관리)
  ✓ 서울특별시에 설치된 AED (당신의 보건소가 관리)
  ✓ 다른 지역의 AED (당신의 보건소가 관리)
  ✗ 다른 보건소가 관리하는 AED
```

---

## 실제 사용 예시

### 상황 1: 지역 기반 점검

**목표:** 당신의 관할 지역에 설치된 모든 AED를 점검

**조작:**
1. 점검 이력 화면에서 **"주소" 모드** 선택
2. 지역 내 모든 장비 목록 조회
3. 각 장비를 방문하여 순회 점검

**결과:**
- 대구광역시 중구에만 설치된 AED가 표시됨
- 출장지의 장비도 포함되지 않음 (위치 기준)

---

### 상황 2: 관리 권한 기반 점검

**목표:** 당신의 보건소가 관리하는 모든 장비의 점검 상태 확인

**조작:**
1. 점검 이력 화면에서 **"관할보건소" 모드** 선택
2. 관리 중인 전국의 모든 장비 목록 조회
3. 점검 이력 및 상태 파악

**결과:**
- 다른 지역에 설치되었지만 당신이 관리하는 AED도 표시됨
- 전국의 관리 장비 현황을 한눈에 볼 수 있음

---

## 단계별 사용 방법

### 1단계: 점검 이력 탭 접속

```
메인 화면 → 점검 관리 → 점검 이력 탭
```

### 2단계: 모드 선택

화면 상단에서 조회 기준을 선택합니다:

```
┌─────────────────────────────────────┐
│ 조회 기준 선택:                      │
│ ○ 주소 (물리적 위치)                │
│ ◉ 관할보건소 (관리 권한)            │
└─────────────────────────────────────┘
```

- **라디오 버튼 클릭**으로 모드 변경
- 선택은 자동으로 저장됨 (새로고침 후에도 유지)

### 3단계: 결과 확인

선택한 모드에 따라 다른 장비 목록이 표시됩니다:

```
장비 목록:
┌─────────────────────────────────────┐
│ ID      │ 위치         │ 관리처      │
├─────────────────────────────────────┤
│ 001     │ 대구 중구    │ 중구 보건소 │
│ 002     │ 대구 중구    │ 중구 보건소 │
│ ...                                  │
└─────────────────────────────────────┘
```

### 4단계: 상세 정보 조회

각 장비의 행을 클릭하면 상세 정보를 확인할 수 있습니다:

```
├─ 기본정보
│  ├─ 장비번호: 29-0000001
│  ├─ 위치: 대구광역시 중구
│  └─ 관리: 중구 보건소
│
├─ 점검이력
│  ├─ 마지막 점검일: 2025-11-07
│  └─ 상태: 정상
│
└─ 관할 정보
   └─ 관할보건소: 중구 보건소
```

---

## 모드별 결과 비교 예시

### 예시: 제주시 보건소 사용자

#### 주소 모드 결과 (제주시에 설치된 AED)
```
ID        | 위치                    | 관리처
----------|------------------------|----------
29-0001   | 제주시 제주시           | 제주시 보건소
29-0002   | 제주시 제주시           | 제주시 보건소
29-0003   | 제주시 제주시           | 제주시 보건소
(총 15개)
```

#### 관할보건소 모드 결과 (제주시 보건소가 관리하는 AED)
```
ID        | 위치                    | 관리처
----------|------------------------|----------
29-0001   | 제주시 제주시           | 제주시 보건소
29-0002   | 제주시 제주시           | 제주시 보건소
29-0003   | 제주시 제주시           | 제주시 보건소
...
13-0050   | 서울특별시 강남구       | 제주시 보건소 *
(총 18개) *타지역의 제주시 보건소 관리 장비
```

---

## 자주 묻는 질문

### Q1: 두 모드의 결과가 다른 이유는?

당신의 지역에 설치된 모든 장비를 당신의 보건소가 관리하는 것은 아닙니다. 다른 보건소가 관리하는 장비가 당신의 지역에 있을 수 있기 때문입니다.

반대로, 당신의 보건소가 관리하지만 다른 지역에 설치된 장비도 있을 수 있습니다.

### Q2: 어느 모드를 사용해야 하나요?

**상황에 따라 선택하세요:**

| 상황 | 추천 모드 |
|------|---------|
| 우리 지역의 모든 장비 점검 | 주소 |
| 우리 보건소 관리 장비 현황 | 관할보건소 |
| 출장 중 관리 장비 확인 | 관할보건소 |
| 지역 기반 순회 계획 | 주소 |

### Q3: 모드 선택이 저장되나요?

네, 선택은 브라우저에 저장됩니다.

- 같은 장치에서는 이전 선택이 유지됨
- 다른 장치에서는 기본값(주소)으로 설정됨

### Q4: 다른 보건소의 장비가 나오는 이유는?

**주소 모드:**
- 당신의 지역에 설치된 장비 중 **다른 보건소가 관리**하는 것도 포함될 수 있음
- 이는 정상이며, 관리처 정보로 확인할 수 있음

**관할보건소 모드:**
- 당신의 보건소가 관리하지만 **다른 지역에 설치**된 장비가 표시됨
- 이는 정상이며, 장비 위치 정보로 확인할 수 있음

### Q5: 권한이 없는 장비가 조회되나요?

아니오, 다음 규칙을 따릅니다:

- **주소 모드**: 당신의 시도/시군구에 설치된 모든 AED (관리자와 무관)
- **관할보건소 모드**: 당신의 보건소가 관리하는 AED만

---

## 문제 해결

### 문제: 장비 목록이 비어있음

**확인사항:**
1. 선택한 모드가 맞나요?
2. 당신의 지역/관리 장비가 DB에 등록되었나요?
3. 완료된 점검 기록이 있나요?

**해결방법:**
- 다른 모드로 변경하여 시도
- 시스템 관리자에게 문의

### 문제: 모드 선택이 저장되지 않음

**확인사항:**
1. 브라우저 쿠키가 활성화되어 있나요?
2. 시크릿/프라이빗 모드를 사용 중인가요?

**해결방법:**
- 쿠키 설정 확인
- 시크릿 모드 비활성화

### 문제: 다른 지역의 장비가 나타남

**이것은 정상입니다:**
- 주소 모드: 다른 보건소가 관리하는 장비가 당신 지역에 있을 수 있음
- 관할보건소 모드: 당신의 보건소 관리 장비가 다른 지역에 있을 수 있음

---

## 추가 정보

- **점검 이력 API**: `/api/inspections/history?mode=address|jurisdiction`
- **지역 코드 가이드**: [지역 코드 가이드](../reference/REGION_CODE_GUIDELINES.md)
- **권한 체계**: [권한 관리 가이드](../CLAUDE.md#핵심-권한-체계)

---

**마지막 업데이트**: 2025-11-07
**문서 버전**: 1.0.0
