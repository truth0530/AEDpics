# NCP 서비스 현황 및 요금 분석

**작성일**: 2025-11-21
**계정**: 국립중앙의료원

---

## 1. 현재 사용 중인 서비스 (전체 목록)

### 1.1 Web Server (Compute)

| 항목 | 값 |
|------|-----|
| 서버명 | aedpics-web-server |
| 서버 스펙 | s2-g3a (3세대) |
| vCPU | 2개 |
| Memory | 8 GB |
| OS | Ubuntu 24.04 |
| Public IP | 223.130.150.133 |
| VPC | aedpics-vpc |
| Subnet | aedpics-public-subnet |

#### 스토리지 구성

| 스토리지명 | 종류 | 용량 | 마운트 | 상태 |
|------------|------|------|--------|------|
| 기본 스토리지 | CB1 (SSD) | 10 GB | /dev/vda | 사용중 |
| aedpics-data-storage | CB1 (SSD) | 20 GB | /dev/vdb (/data) | 사용중 (2025-11-21 추가) |

**총 스토리지**: 30 GB

### 1.2 Cloud DB for PostgreSQL

| 항목 | 값 |
|------|-----|
| 서비스명 | aedpics-service |
| 서버명 | aedpics-db-001-88po |
| 서버 세대 | G2 |
| vCPU | 2개 |
| Memory | 8 GB |
| 스토리지 종류 | SSD |
| 스토리지 용량 | 10 GB |
| 백업 스토리지 | 0.33 GB/월 |
| 역할 | Standalone |
| 호스트 | pg-3aqmb1.vpc-pub-cdb-kr.ntruss.com |
| 포트 | 5432 |

### 1.3 네트워킹

| 서비스 | 사용량 | 설명 |
|--------|--------|------|
| VPC (Virtual Private Cloud) | 1개 | aedpics-vpc |
| Public IP | 1개 | 223.130.150.133 |
| Network (Cloud DB) | 10.09 GB | DB 네트워크 트래픽 |

### 1.4 부가 서비스

| 서비스 | 사용량 | 설명 |
|--------|--------|------|
| Cloud Outbound Mailer | 199건 | 이메일 발송 서비스 |
| Storage (추가) | 1개 | 20GB CB1 (2025-11-21 추가) |

---

## 2. 실제 요금 현황

### 2.1 크레딧 현황 (2025-11-21 확인)

| 항목 | 값 |
|------|-----|
| 크레딧명 | Credit Discount to New Customers Plus |
| 총 크레딧 | 300,000원 |
| 10월 사용 | 51,320원 |
| 11월 사용 (20일) | 179,450원 |
| **잔여 크레딧** | **69,230원** |
| 유효 기간 | 2025-10-01 ~ 2026-01-31 |
| **현재 청구 금액** | **0원** (100% 크레딧 할인) |

### 2.2 월별 사용량 상세

#### 2025년 10월 (부분 사용 - 서비스 시작)

| 서비스 | 금액 |
|--------|------|
| Cloud DB for PostgreSQL | 38,500원 |
| Server (VPC) | 11,840원 |
| Public IP | 580원 |
| Block Storage | 240원 |
| Server Base Block Storage | 160원 |
| **10월 총계** | **51,320원** |

#### 2025년 11월 (11/1~11/20, 20일 기준)

| 서비스 | 금액 |
|--------|------|
| Cloud DB for PostgreSQL | 120,030원 |
| Server (VPC) | 55,200원 |
| Public IP | 2,680원 |
| Block Storage | 760원 |
| Server Base Block Storage | 760원 |
| Network | 20원 |
| Cloud Outbound Mailer | 0원 (1,000건 무료) |
| **11월 총계 (20일)** | **179,450원** |

### 2.3 정확한 월간 요금 산정

| 항목 | 계산 | 금액 |
|------|------|------|
| 11월 20일 사용량 | 실측 | 179,450원 |
| 일일 평균 | 179,450 / 20 | 8,972원 |
| **30일 환산 월간 요금** | 8,972 × 30 | **약 269,000원/월** |
| 추가 스토리지 20GB | 11/21 증설분 | +약 2,300원/월 |
| **최종 예상 월간 요금** | | **약 271,000원/월** |

### 2.4 결제 일정 및 예상 청구 금액

#### 결제 수단
- **자동이체**: 신용카드 (신한카드, 유효기간 08/26)
- **등록일**: 2025년 10월 25일

#### 11월 예상 청구 금액

| 항목 | 금액 |
|------|------|
| 11월 전체 사용량 (30일) | 약 269,000원 |
| 잔여 크레딧 차감 | -69,230원 |
| **11월 실제 청구 예상** | **약 200,000원** |

#### 향후 결제 일정

| 결제일 | 청구 대상 | 예상 금액 | 비고 |
|--------|----------|----------|------|
| **2025년 12월 10~14일** | 11월분 | **약 200,000원** | 첫 카드 결제 |
| 2026년 1월 10~14일 | 12월분 | 약 271,000원 | 정상 월 요금 |
| 2026년 2월 10~14일 | 1월분 | 약 271,000원 | 정상 월 요금 |

#### NCP 결제 체계

- **요금 산정**: 매월 1일~말일 사용량 기준 (일별 누적)
- **청구서 발행**: 익월 3일 (이메일/SMS 통지)
- **자동결제**: 익월 10~14일
- **즉시납부**: 매월 4일부터 [마이페이지>서비스 이용 내역]에서 가능

**참고**: 11월 30일이 지나야 정확한 11월 요금이 확정됩니다.

---

## 3. 요금 계산기 vs 실제 요금 비교

### 3.1 서비스별 계산기 요금 (2025-11-21 검증)

| 서비스 | 계산기 요금 | 실제 30일 환산 | 차이 |
|--------|------------|---------------|------|
| Server (G3, 2vCPU, 8GB, 30GB CB1) | 85,696원 | 약 84,000원 | -1,696원 |
| Cloud DB for PostgreSQL | 180,100원 | 약 180,000원 | -100원 |
| Public IP (1개) | 4,032원 | 약 4,000원 | -32원 |
| Cloud Outbound Mailer (199건) | 0원 | 0원 | 0원 |
| **계산기 총액** | **269,828원** | **약 269,000원** | **-828원** |

### 3.2 핵심 발견: 계산기가 정확했음

**이전 오해**: 179,450원이 월간 요금이라고 착각
**실제**: 179,450원은 20일(11/1~11/20) 사용량

**30일 환산 시**:
- Server: 55,200원 / 20일 × 30일 = **82,800원**
- Cloud DB: 120,030원 / 20일 × 30일 = **180,045원**
- Public IP: 2,680원 / 20일 × 30일 = **4,020원**
- 기타: 약 2,000원
- **총계: 약 269,000원/월**

**결론**: 요금 계산기(269,828원)가 실제 월간 요금(약 269,000원)과 거의 일치

### 3.3 요금 계산기 정확도 분석

| 서비스 유형 | 정확도 | 비고 |
|------------|--------|------|
| Server (Compute) | **높음** | 1,000원 내외 차이 |
| Cloud DB | **높음** | 거의 일치 (180,100원 vs 180,045원) |
| Public IP | **높음** | 거의 일치 |
| Cloud Outbound Mailer | **높음** | 1,000건 무료 정확 |

### 3.4 계산기 UI 한계점

1. **UI 버그**: 서비스 추가 시 이전 설정이 리셋되어 여러 서비스 동시 계산 불가
2. **해결 방법**: 각 서비스별로 따로 계산 후 합산

**권장사항**: 요금 계산기 결과를 신뢰할 수 있음. 전체 월간 요금 예상에 유용

---

## 4. 증설 필요 여부 검토

### 4.1 현재 리소스 사용률 (2025-11-21)

| 리소스 | 사용률 | 상태 | 증설 필요 |
|--------|--------|------|----------|
| **CPU** | 0.36% | 양호 | X |
| **Memory** | 11.06% | 양호 | X |
| **Disk** | 30.85% | 양호 (개선됨) | X |

### 4.2 서비스별 증설 검토

| 서비스 | 현재 사용량 | 한도/용량 | 증설 필요 | 권장 사항 |
|--------|-------------|----------|----------|----------|
| **Server vCPU** | 0.36% | 2개 | X | 현재 충분 |
| **Server Memory** | 11.06% | 8GB | X | 현재 충분 |
| **Server Storage** | 30.85% | 30GB | X | 최근 증설 완료 |
| **Cloud DB Storage** | - | 10GB | 모니터링 | 데이터 증가 시 자동 확장 |
| **Cloud DB Backup** | 0.33GB | 자동 | X | 정상 |
| **Network Traffic** | 10.09GB | 100GB 무료 | X | 여유 있음 |
| **Cloud Outbound Mailer** | 199건 | - | 모니터링 | 발송량 증가 시 검토 |
| **Public IP** | 1개 | - | X | 현재 충분 |

### 4.3 결론: 증설 불필요

현재 모든 서비스가 정상 범위 내에서 운영되고 있으며, 즉시 증설이 필요한 항목은 없습니다.

**모니터링 필요 항목:**
1. **Cloud DB Storage**: 데이터 증가 추이 확인 (자동 확장 설정됨)
2. **Cloud Outbound Mailer**: 이메일 발송량 증가 시 요금제 검토

---

## 5. 인프라 현황 요약

### 5.1 디스크 사용률 변화

| 시점 | 사용률 | 가용 공간 |
|------|--------|-----------|
| 증설 전 (11월 초) | 92.69% | 689MB |
| node_modules 이동 후 | 81% | 1.9GB |
| 현재 (Dashboard 기준) | **30.85%** | 약 6.8GB |

**개선 효과**: 스토리지 증설 + node_modules 이동으로 디스크 문제 해결

### 5.2 서비스 상태

| 서비스 | 상태 | 비고 |
|--------|------|------|
| PM2 Cluster | Online (2 instances) | 정상 운영 중 |
| Nginx | Active | HTTPS 활성화 |
| PostgreSQL | Running | NCP Cloud DB |
| 웹사이트 | https://aed.pics | HTTP 200 OK |

---

## 6. 비용 최적화 방안

### 6.1 현재 상황 평가

**실제 월 요금: 약 271,000원** (스토리지 증설 반영)

| 구분 | 금액 |
|------|------|
| 기본 월 요금 | 약 269,000원 |
| 추가 스토리지 20GB | 약 2,300원 |
| **총 월간 요금** | **약 271,000원** |

**현재 청구**: 0원 (크레딧 할인 적용 중, 11월 28일경 소진 예상)

### 6.2 추가 절감 가능 방안

1. **약정 할인 (강력 권장)**
   - 1년 약정: 최대 24% 할인 → **약 206,000원/월**
   - 3년 약정: 최대 40% 할인 → **약 163,000원/월**
   - **연간 절감액**: 약 780,000원 ~ 1,296,000원

2. **크레딧 추가 확보**
   - 현재 잔여: 69,230원 (약 7~8일분)
   - NCP 프로모션 크레딧 확인
   - 공공기관 지원 프로그램 확인

3. **서버 스펙 다운그레이드 (신중 검토)**
   - 현재 메모리 사용률 11%로 낮음
   - 단, 빌드 시 메모리 급증하므로 주의 필요

### 6.3 비용 구조 분석

| 서비스 | 월 요금 | 비중 |
|--------|---------|------|
| Cloud DB for PostgreSQL | 180,000원 | 67% |
| Server (VPC) | 83,000원 | 31% |
| Public IP | 4,000원 | 1% |
| 기타 | 4,000원 | 1% |
| **합계** | **271,000원** | 100% |

**Cloud DB가 전체 비용의 67%를 차지**하므로, 비용 절감 시 Cloud DB 약정 할인을 우선 검토

---

## 7. 향후 예상 비용 증가 요인

| 항목 | 예상 시점 | 예상 추가 비용 |
|------|----------|---------------|
| Object Storage (이미지) | 점검 기능 본격 사용 시 | 월 5,000원 ~ |
| Cloud DB 용량 증가 | 데이터 증가 시 (자동) | 자동 확장 |
| 네트워크 트래픽 | 사용자 증가 시 | 100GB 초과분 |
| 이메일 발송량 | 사용자 증가 시 | 발송량에 따라 |

---

## 8. 주요 연락처

| 역할 | 이메일 |
|------|--------|
| 시스템 관리자 | truth0530@nmc.or.kr |
| 기술 지원 | inhak@nmc.or.kr |
| 프로젝트 매니저 | woo@nmc.or.kr |

---

## 9. 관련 문서

- [NCP 마이그레이션 완전가이드](migration/NCP_마이그레이션_완전가이드.md)
- [NCP 서버 설정 가이드](deployment/NCP_SERVER_SETUP.md)
- [배포 절차](deployment/DEPLOYMENT.md)
- [성능 최적화 가이드](guides/PERFORMANCE_OPTIMIZATION.md)

---

## 변경 이력

| 날짜 | 내용 | 작성자 |
|------|------|--------|
| 2025-11-21 | 최초 작성 - 스토리지 증설 및 요금 분석 | Claude |
| 2025-11-21 | 실제 청구 요금 반영, 전체 서비스 목록 추가, 증설 검토 | Claude |
| 2025-11-21 | 요금 계산기 검증 완료, 계산기 한계점 및 정확도 분석 추가 | Claude |
| 2025-11-21 | **정확한 요금 산정 완료**: 크레딧 내역 확인, 월별 사용량 분석, 30일 환산 요금(271,000원/월) 산정 | Claude |
| 2025-11-21 | **결제 일정 추가**: 첫 카드 결제(12/10~14, 약 20만원), NCP 결제 체계, 향후 결제 일정 | Claude |

