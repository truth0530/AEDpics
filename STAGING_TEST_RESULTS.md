# 스테이징 테스트 결과 보고서

**테스트 날짜**: ________________
**테스트자**: ________________
**테스트 환경**: https://staging.aed.pics
**배포 버전**: 716b39c (로그인/로그아웃 성능 및 안정성 개선)

---

## 배포 후 서버 상태 확인

### PM2 상태
```
실행 명령어: pm2 status
실행 시간: ________________

출력 결과:
[여기에 pm2 status 출력 붙여넣기]

상태 확인:
□ status: online (필수)
□ restarts: 0 (배포 직후 재시작 없음)
□ CPU 사용률: _____% (정상: < 50%)
□ 메모리 사용률: _____MB (정상: < 500MB)
```

### HTTP 응답 확인
```
실행 명령어: curl -I https://staging.aed.pics
실행 시간: ________________

출력 결과:
[여기에 curl 출력 붙여넣기]

확인 항목:
□ HTTP 상태 코드: 200 OK (필수)
□ 응답 시간: ____ms (정상: < 1000ms)
```

### 에러 로그 확인
```
실행 명령어: pm2 logs --err --lines 20
실행 시간: ________________

에러 발견:
□ 없음 (정상)
□ 있음 (아래에 기록)

발견된 에러:
[에러 내용 기록]
```

**서버 상태 종합 평가**:
□ 통과 (모든 항목 정상)
□ 경고 (일부 항목 주의 필요)
□ 실패 (배포 재실행 필요)

---

## Test 1: 로그인 성능

**테스트 목표**: 스피너 표시 < 200ms, 전체 완료 < 2초

### 1-1. 정상 네트워크 환경

**테스트자**: ________________
**테스트 시간**: ________________

```javascript
// 콘솔에서 측정한 시간
SPINNER_DELAY: ____ms
LOGIN_TOTAL: ____ms
```

**성능 평가**:
- [ ] SPINNER_DELAY < 200ms (통과 기준)
- [ ] LOGIN_TOTAL < 2000ms (통과 기준)
- 실제 측정 결과 평가:
  - SPINNER_DELAY: _____ms → [ ] 통과 / [ ] 미통과
  - LOGIN_TOTAL: _____ms → [ ] 통과 / [ ] 미통과

**관찰 사항**:
```
- 스피너 표시 시점: ________________
- 스피너 애니메이션: [ ] 부드러움 / [ ] 끊김
- 페이지 전환: [ ] 자연스러움 / [ ] 버벅거림
- 기타 문제: ________________
```

**이전 버전과의 비교** (체감):
```
변경 전 (3-5초): ________________________________________
변경 후: ________________________________________
개선도: [ ] 눈에 띄는 개선 / [ ] 약간 개선 / [ ] 미미함
```

### 1-2. 3G 네트워크 환경 (Slow 3G)

**테스트자**: ________________
**테스트 시간**: ________________

```javascript
// 콘솔에서 측정한 시간
SPINNER_DELAY: ____ms
LOGIN_TOTAL: ____ms (예상: 5-10초)
```

**성능 평가**:
- [ ] 스피너가 표시됨 (매우 중요!)
- [ ] Network 탭에서 요청 순서 확인 가능
- [ ] 사용자가 "로딩 중"임을 인식 가능

**관찰 사항**:
```
- 느린 네트워크에서 UI 반응성: [ ] 양호 / [ ] 미흡
- 스피너 표시 여부: [ ] 표시됨 / [ ] 표시 안 됨
- 사용자 경험: ________________
```

**Test 1 종합 평가**:
```
□ 통과 (성능 개선 확인됨)
□ 부분 통과 (일부 개선됨)
□ 미통과 (성능 개선 미흡)

상세 평가:
________________________________________________________________________________
________________________________________________________________________________
```

---

## Test 2: 로그아웃 안정성

**테스트 목표**: 모든 상황에서 /auth/signin으로 이동

### 2-1. 정상 로그아웃

**테스트자**: ________________
**테스트 시간**: ________________

```
로그아웃 실행:
- 프로필 드롭다운 또는 로그아웃 버튼 클릭
- 시간 측정: ____초
- 목표 페이지: /auth/signin

결과:
□ /auth/signin으로 정상 이동 (통과)
□ 이동 실패 또는 지연 (미통과)
□ 에러 메시지 표시 (미통과)

콘솔 메시지:
[콘솔 메시지 기록]
```

### 2-2. 네트워크 오류 시뮬레이션

**테스트자**: ________________
**테스트 시간**: ________________

```
설정: Network 탭 > Offline 체크

로그아웃 실행:
- 로그아웃 버튼 클릭
- 콘솔에서 에러 메시지 확인
- /auth/signin으로 이동 여부 확인

결과:
□ 에러 로그 출력: "로그아웃 처리 중 오류:" (예상)
□ 그럼에도 /auth/signin으로 이동 (중요!)
□ 사용자가 갇히지 않음

콘솔 에러 메시지:
[에러 메시지 복사]

평가:
□ 완벽한 error handling (try-catch 작동)
□ 부분적으로 작동
□ 작동 실패 (사용자 갇힘)
```

### 2-3. 느린 네트워크 시뮬레이션 (Slow 3G)

**테스트자**: ________________
**테스트 시간**: ________________

```
설정: Network 탭 > Slow 3G

로그아웃 실행:
- 로그아웃 버튼 클릭
- 시간 측정 (최대 10초까지)
- /auth/signin으로 이동 확인

결과:
소요 시간: ____초
도착 페이지: [ ] /auth/signin / [ ] 다른 페이지 / [ ] 도달 실패

평가:
□ 느려도 정상 작동 (통과)
□ 타임아웃 또는 실패 (미통과)
```

**Test 2 종합 평가**:
```
□ 통과 (모든 상황에서 안정적)
□ 부분 통과 (일부 상황에서 실패)
□ 미통과 (안정성 미흡)

상세 평가:
- 정상 로그아웃: [ ] 통과 / [ ] 미통과
- 네트워크 오류: [ ] 통과 / [ ] 미통과
- 느린 네트워크: [ ] 통과 / [ ] 미통과

추가 의견:
________________________________________________________________________________
________________________________________________________________________________
```

---

## Test 3: 민감정보 필터링

**테스트 목표**: API 응답에서 보안 민감 정보 미노출

### 검증 방법

**테스트자**: ________________
**테스트 시간**: ________________

```
1. 로그인하여 대시보드 접속
2. Chrome 개발자 도구 > Network 탭
3. "/api/user/profile" 요청 찾기
4. Response 탭에서 JSON 확인
```

### 제외되어야 하는 필드 (보안)

| 필드명 | 설명 | 상태 | 비고 |
|--------|------|------|------|
| password_hash | 해시된 비밀번호 | [ ] 없음 | 필수 |
| account_locked | 계정 잠금 여부 | [ ] 없음 | 필수 |
| lock_reason | 잠금 사유 | [ ] 없음 | 필수 |
| approval_status | 승인 상태 | [ ] 없음 | 필수 |

### 포함되어야 하는 필드 (필수)

| 필드명 | 설명 | 상태 | 값 예시 |
|--------|------|------|---------|
| id | 사용자 ID | [ ] 있음 | uuid |
| email | 이메일 | [ ] 있음 | user@nmc.or.kr |
| full_name | 이름 | [ ] 있음 | 홍길동 |
| role | 역할 | [ ] 있음 | regional_admin |
| organization_id | 조직 ID | [ ] 있음 | uuid |
| organization_name | 조직명 | [ ] 있음 | 서울 강서구 보건소 |
| is_active | 활성 여부 | [ ] 있음 | true/false |
| created_at | 생성 날짜 | [ ] 있음 | ISO 8601 |
| updated_at | 수정 날짜 | [ ] 있음 | ISO 8601 |

### API 응답 전체 (실제 응답 복사)

```json
[실제 API 응답 JSON을 여기에 붙여넣기]
```

### 보안 평가

```
필터링 상태:
□ 완벽 (모든 민감 정보 제외, 필요 정보 모두 포함)
□ 양호 (대부분 정상, 1-2개 항목 미흡)
□ 미흡 (민감 정보 노출됨)

노출된 민감 정보 (있을 경우):
- ________________
- ________________

추가 확인 사항:
- 다른 API 엔드포인트도 동일하게 필터링되는지 확인: [ ]
```

**Test 3 종합 평가**:
```
□ 통과 (모든 민감 정보 제외됨)
□ 미통과 (민감 정보 노출됨)

상세 평가:
________________________________________________________________________________
________________________________________________________________________________
```

---

## Test 4: 프로필 로드 실패 폴백

**테스트 목표**: 프로필 API 장애 시 /dashboard로 자동 이동

### 설정: Network 요청 차단

**테스트자**: ________________
**테스트 시간**: ________________

```
콘솔에 다음 코드 실행:

const originalFetch = window.fetch;
window.fetch = async (url, options) => {
  if (url.includes('/api/user/profile')) {
    throw new Error('Network error (simulated)');
  }
  return originalFetch(url, options);
};
console.log('프로필 API 차단됨. 이제 로그인하세요.');
```

### 테스트 실행

```
1. 위 코드 실행 (프로필 API만 차단)
2. 로그인 버튼 클릭
3. 다음 확인:
   - 콘솔에 에러 메시지 표시
   - /dashboard로 자동 이동
   - 사용자가 페이지에 갇히지 않음

결과:
□ 에러 메시지 출력: "프로필 로드 실패: ..." (예상)
  - 실제 메시지: ________________

□ 페이지 이동:
  - 예상 페이지: /dashboard
  - 실제 이동 페이지: ________________
  - 이동 시간: ____초

□ 사용자 경험:
  - 에러 표시: [ ] 있음 / [ ] 없음
  - 페이지 이동: [ ] 자동 / [ ] 사용자가 조작해야 함
  - 갇힘: [ ] 없음 / [ ] 있음 (문제!)
```

**Test 4 종합 평가**:
```
□ 통과 (폴백 정상 작동)
□ 부분 통과 (이동하지만 지연)
□ 미통과 (폴백 미작동)

상세 평가:
- 에러 감지: [ ] 정상 / [ ] 미흡
- 자동 폴백: [ ] 정상 / [ ] 미흡
- 사용자 보호: [ ] 정상 / [ ] 미흡

추가 의견:
________________________________________________________________________________
________________________________________________________________________________
```

---

## 종합 평가

### 테스트 결과 요약

| 테스트 | 목표 | 결과 | 평가 |
|--------|------|------|------|
| Test 1 | 로그인 성능 < 2초 | [ ] 통과 / [ ] 미통과 | _____ |
| Test 2 | 로그아웃 안정성 | [ ] 통과 / [ ] 미통과 | _____ |
| Test 3 | 민감정보 필터링 | [ ] 통과 / [ ] 미통과 | _____ |
| Test 4 | 프로필 폴백 | [ ] 통과 / [ ] 미통과 | _____ |

### 성능 개선 검증

**변경 전 vs 변경 후 체감**:
```
로그인 성능:
- 변경 전: 3-5초 (스피너 없음, 답답함)
- 변경 후: 1-2초 (스피너 있음, 명확함)
- 개선도: [ ] 매우 개선 / [ ] 개선 / [ ] 미미 / [ ] 없음

로그아웃 안정성:
- 변경 전: 네트워크 오류 시 갇힘
- 변경 후: 항상 이동
- 개선도: [ ] 매우 개선 / [ ] 개선 / [ ] 미미 / [ ] 없음
```

### 최종 판정

```
전체 테스트 결과: [ ] 통과 / [ ] 미통과

통과 기준:
- 4개 테스트 모두 "통과"
- 성능 목표 달성 (로그인 < 2초, 스피너 < 200ms)
- 안정성 확인 (모든 오류 상황 처리)
- 보안 검증 (민감 정보 미노출)

미통과 시 사유:
________________________________________________________________________________
________________________________________________________________________________

재테스트 필요 여부:
□ 재테스트 필요 없음 (모두 통과)
□ 부분 재테스트 필요 (______ 항목)
□ 전체 재테스트 필요
```

### 테스트자 서명

```
테스트자 이름: ________________
테스트 완료 날짜: ________________
테스트 완료 시간: ________________

서명: ________________

검토자 이름: ________________
검토 날짜: ________________
검토 결과: [ ] 승인 / [ ] 거부

검토자 서명: ________________
```

---

## 배포 승인 여부

### 스테이징 테스트 통과 시

```
이 보고서를 바탕으로 프로덕션 배포 승인:

□ 승인 (모든 테스트 통과, 성능 개선 확인)
  → 다음 단계: 프로덕션 배포 진행
  → 참조 가이드: PRODUCTION_DEPLOYMENT_GUIDE.md

□ 조건부 승인 (일부 항목만 통과)
  → 필요한 수정사항: ________________
  → 재테스트 일정: ________________

□ 거부 (기준 미충족)
  → 사유: ________________
  → 개선 필요 사항: ________________
  → 재배포 일정: ________________
```

---

## 부록: 상세 데이터

### Chrome DevTools Network 탭 분석

```
요청 순서 및 시간:
1. POST /api/auth/callback/signin
   - 시간: ____ms
   - authorize 함수 실행 시간

2. GET /api/auth/session
   - 시간: ____ms
   - 세션 정보 조회

3. GET /api/user/profile/{id}
   - 시간: ____ms
   - 프로필 정보 조회

전체 합계: ____ms
```

### 콘솔 메시지 로그

```javascript
// 테스트 중 콘솔에 출력된 메시지들
[여기에 중요한 콘솔 메시지 복사]
```

### 브라우저 메모리 사용량

```
로그인 전: ____MB
로그인 후: ____MB
증가량: ____MB
정상 범위: < 100MB 증가
```

---

**테스트 보고서 완료 날짜**: ________________
**보고서 작성자**: ________________

